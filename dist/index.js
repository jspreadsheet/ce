if (! jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

if (! formula && typeof(require) === 'function') {
    var formula = require('@jspreadsheet/formula');
}

;(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    global.jspreadsheet = factory();
}(this, (function () {

var jspreadsheet;(function(){"use strict";var __webpack_modules__={100:function(e,t){const n=function(e){const t=this,n=[];for(let s=0;s<e.length;s++){const o=e[s].x,l=e[s].y,r=t.options.columns[o].name?t.options.columns[o].name:o;n[l]||(n[l]={row:l,data:{}}),n[l].data[r]=e[s].value}return n.filter((function(e){return null!=e}))},s=function(e,t){const n=this,s=o.call(n.parent,"onbeforesave",n.parent,n,t);if(s)t=s;else if(!1===s)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){o.call(n,"onsave",n.parent,n,t)}})},o=function(e){const t=this;let o=null,l=t.parent?t.parent:t;if(!l.ignoreEvents&&("function"==typeof l.config.onevent&&(o=l.config.onevent.apply(this,arguments)),"function"==typeof l.config[e]&&(o=l.config[e].apply(this,Array.prototype.slice.call(arguments,1))),"object"==typeof l.plugins)){const e=Object.keys(l.plugins);for(let t=0;t<e.length;t++){const n=e[t],s=l.plugins[n];"function"==typeof s.onevent&&(o=s.onevent.apply(this,arguments))}}if("onafterchanges"==e){const e=arguments;if("object"==typeof l.plugins&&Object.entries(l.plugins).forEach((function([,n]){"function"==typeof n.persistence&&n.persistence(t,"setValue",{data:e[2]})})),t.options.persistence){const e=1==t.options.persistence?t.options.url:t.options.persistence,o=n.call(t,arguments[2]);s.call(t,e,o)}}return o};t.Z=o},456:function(e,t,n){n.d(t,{B4:function(){return l},aw:function(){return i},ql:function(){return r}});var s=n(992),o=n(366);const l=function(e){const t=this;if(t.options.filters){e=parseInt(e),t.resetSelection();let n=[];if("checkbox"==t.options.columns[e].type)n.push({id:"true",name:"True"}),n.push({id:"false",name:"False"});else{const s=[];let o=!1;for(let n=0;n<t.options.data.length;n++){const l=t.options.data[n][e],r=t.records[n][e].element.innerHTML;l&&r?s[l]=r:o=!0}const l=Object.keys(s);n=[];for(let e=0;e<l.length;e++)n.push({id:l[e],name:s[l[e]]});o&&n.push({value:"",id:"",name:"(Blanks)"})}const s=document.createElement("div");t.filter.children[e+1].innerHTML="",t.filter.children[e+1].appendChild(s),t.filter.children[e+1].style.paddingLeft="0px",t.filter.children[e+1].style.paddingRight="0px",t.filter.children[e+1].style.overflow="initial";const l={data:n,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==t.filters[e]?t.filters[e]:null,width:"100%",position:1==t.options.tableOverflow||1==t.parent.config.fullscreen,onclose:function(n){i.call(t),t.filters[e]=n.dropdown.getValue(!0),t.filter.children[e+1].innerHTML=n.dropdown.getText(),t.filter.children[e+1].style.paddingLeft="",t.filter.children[e+1].style.paddingRight="",t.filter.children[e+1].style.overflow="",r.call(t,e),o.E.call(t)}};jSuites.dropdown(s,l)}else console.log("Jspreadsheet: filters not enabled.")},r=function(e){const t=this;if(!e)for(let n=0;n<t.filter.children.length;n++)t.filters[n]&&(e=n);const n=function(e,n,s){for(let o=0;o<e.length;o++){const l=""+t.options.data[s][n],r=""+t.records[s][n].element.innerHTML;if(e[o]==l||e[o]==r)return!0}return!1},o=t.filters[e];t.results=[];for(let s=0;s<t.options.data.length;s++)n(o,e,s)&&t.results.push(s);t.results.length||(t.results=null),s.cW.call(t)},i=function(){const e=this;if(e.options.filters)for(let t=0;t<e.filter.children.length;t++)e.filter.children[t].innerHTML="&nbsp;",e.filters[t]=null;e.results=null,s.cW.call(e)}},427:function(e,t,n){n.d(t,{i:function(){return o}});var s=n(992);const o=function(e){const t=this;if(e&&(t.options.footers=e),t.options.footers){t.tfoot||(t.tfoot=document.createElement("tfoot"),t.table.appendChild(t.tfoot));for(let e=0;e<t.options.footers.length;e++){let n;if(t.tfoot.children[e])n=t.tfoot.children[e];else{n=document.createElement("tr");const e=document.createElement("td");n.appendChild(e),t.tfoot.appendChild(n)}for(let o=0;o<t.headers.length;o++){let l;if(t.options.footers[e][o]||(t.options.footers[e][o]=""),t.tfoot.children[e].children[o+1])l=t.tfoot.children[e].children[o+1];else{l=document.createElement("td"),n.appendChild(l);const e=t.options.columns[o].align||t.options.defaultColAlign||"center";l.style.textAlign=e}l.textContent=s.H2.call(t,+t.records.length+o,e,t.options.footers[e][o]),l.style.display=t.cols[o].colElement.style.display}}}}},157:function(e,t,n){n.d(t,{I:function(){return s}});const s=function(){const e=this;let t=0;if(e.options.freezeColumns>0)for(let n=0;n<e.options.freezeColumns;n++){let s;s=e.options.columns&&e.options.columns[n]&&void 0!==e.options.columns[n].width?parseInt(e.options.columns[n].width):void 0!==e.options.defaultColWidth?parseInt(e.options.defaultColWidth):100,t+=s}return t}},650:function(e,t,n){n.r(t),n.d(t,{createFromTable:function(){return d},getCaretIndex:function(){return o},getCellNameFromCoords:function(){return i},getColumnName:function(){return r},getCoordsFromCellName:function(){return c},getCoordsFromRange:function(){return a},invert:function(){return l},parseCSV:function(){return u}});var s=n(323);const o=function(e){let t;t=this.config.root?this.config.root:window;let n=0;const s=t.getSelection();if(s&&0!==s.rangeCount){const t=s.getRangeAt(0),o=t.cloneRange();o.selectNodeContents(e),o.setEnd(t.endContainer,t.endOffset),n=o.toString().length}return n},l=function(e){const t=[],n=Object.keys(e);for(let s=0;s<n.length;s++)t[e[n[s]]]=n[s];return t},r=function(e){let t="";return e>701?(t+=String.fromCharCode(64+parseInt(e/676)),t+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(t+=String.fromCharCode(64+parseInt(e/26))),t+=String.fromCharCode(65+e%26),t},i=function(e,t){return r(parseInt(e))+(parseInt(t)+1)},c=function(e){const t=/^[a-zA-Z]+/.exec(e);if(t){let n=0;for(let e=0;e<t[0].length;e++)n+=parseInt(t[0].charCodeAt(e)-64)*Math.pow(26,t[0].length-1-e);n--,n<0&&(n=0);let s=parseInt(/[0-9]+$/.exec(e))||null;return s>0&&s--,[n,s]}},a=function(e){const[t,n]=e.split(":");return[...c(t),...c(n)]},u=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";const n=[];let s=!1;for(let o=0,l=0,r=0;r<e.length;r++){const i=e[r],c=e[r+1];n[o]=n[o]||[],n[o][l]=n[o][l]||"",'"'==i&&s&&'"'==c?(n[o][l]+=i,++r):'"'!=i?i!=t||s?"\r"!=i||"\n"!=c||s?"\n"==i&&!s||"\r"==i&&!s?(++o,l=0):n[o][l]+=i:(++o,l=0,++r):++l:s=!s}return n},d=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];const n=e.querySelectorAll("colgroup > col");if(n.length)for(let e=0;e<n.length;e++){let s=n[e].style.width;s||(s=n[e].getAttribute("width")),s&&(t.columns[e]||(t.columns[e]={}),t.columns[e].width=s)}const o=function(e,n){let s=e.getBoundingClientRect();const o=s.width>50?s.width:50;t.columns[n]||(t.columns[n]={}),e.getAttribute("data-celltype")?t.columns[n].type=e.getAttribute("data-celltype"):t.columns[n].type="text",t.columns[n].width=o+"px",t.columns[n].title=e.innerHTML,e.style.textAlign&&(t.columns[n].align=e.style.textAlign),(s=e.getAttribute("name"))&&(t.columns[n].name=s),(s=e.getAttribute("id"))&&(t.columns[n].id=s),(s=e.getAttribute("data-mask"))&&(t.columns[n].mask=s)},l=[];let r=e.querySelectorAll(":scope > thead > tr");if(r.length){for(let e=0;e<r.length-1;e++){const t=[];for(let n=0;n<r[e].children.length;n++){const s={title:r[e].children[n].textContent,colspan:r[e].children[n].getAttribute("colspan")||1};t.push(s)}l.push(t)}r=r[r.length-1].children;for(let e=0;e<r.length;e++)o(r[e],e)}let i=0;const c={},a={},u={},d={};let p=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(let e=0;e<p.length;e++)if(t.data[i]=[],1!=t.parseTableFirstRowAsHeader||r.length||0!=e){for(let n=0;n<p[e].children.length;n++){let o=p[e].children[n].getAttribute("data-formula");o?"="!=o.substr(0,1)&&(o="="+o):o=p[e].children[n].innerHTML,t.data[i].push(o);const l=(0,s.Ar)([n,e]),r=p[e].children[n].getAttribute("class");r&&(d[l]=r);const a=parseInt(p[e].children[n].getAttribute("colspan"))||0,h=parseInt(p[e].children[n].getAttribute("rowspan"))||0;(a||h)&&(c[l]=[a||1,h||1]),p[e].children[n].style&&"none"==p[e].children[n].style.display&&(p[e].children[n].style.display="");const m=p[e].children[n].getAttribute("style");m&&(u[l]=m),p[e].children[n].classList.contains("styleBold")&&(u[l]?u[l]+="; font-weight:bold;":u[l]="font-weight:bold;")}p[e].style&&p[e].style.height&&(a[e]={height:p[e].style.height}),i++}else for(let t=0;t<p[e].children.length;t++)o(p[e].children[t],t);if(Object.keys(l).length>0&&(t.nestedHeaders=l),Object.keys(u).length>0&&(t.style=u),Object.keys(c).length>0&&(t.mergeCells=c),Object.keys(a).length>0&&(t.rows=a),Object.keys(d).length>0&&(t.classes=d),p=e.querySelectorAll("tfoot tr"),p.length){const e=[];for(let t=0;t<p.length;t++){let n=[];for(let e=0;e<p[t].children.length;e++)n.push(p[t].children[e].textContent);e.push(n)}Object.keys(e).length>0&&(t.footers=e)}if(1==t.parseTableAutoCellType){const e=[];for(let n=0;n<t.columns.length;n++){let s=!0,o=!0;e[n]=[];for(let l=0;l<t.data.length;l++){const r=t.data[l][n];e[n][r]||(e[n][r]=0),e[n][r]++,r.length>25&&(s=!1),10==r.length&&"-"==r.substr(4,1)&&"-"==r.substr(7,1)||(o=!1)}const l=Object.keys(e[n]).length;o?t.columns[n].type="calendar":1==s&&l>1&&l<=parseInt(.1*t.data.length)&&(t.columns[n].type="dropdown",t.columns[n].source=Object.keys(e[n]))}}return t}console.log("Element is not a table")}},923:function(e,t,n){n.d(t,{JB:function(){return a},KX:function(){return h},Yw:function(){return p}});var s=n(100),o=n(323),l=n(992),r=n(49),i=n(54),c=n(366);const a=function(e){const t=this;if(1!=t.ignoreHistory){const n=++t.historyIndex;t.history=t.history=t.history.slice(0,n+1),t.history[n]=e}},u=function(e,t){const n=this,s=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==n.options.search&&n.results&&n.results.length!=n.rows.length&&n.resetSearch(),1==e){const e=t.numOfRows;for(let t=s;t<e+s;t++)n.rows[t].element.parentNode.removeChild(n.rows[t].element);n.records.splice(s,e),n.options.data.splice(s,e),n.rows.splice(s,e),c.Uv.call(n,1,s,e+s-1)}else{n.records=(0,o.Wc)(n.records,s,t.rowRecords),n.options.data=(0,o.Wc)(n.options.data,s,t.rowData),n.rows=(0,o.Wc)(n.rows,s,t.rowNode);let e=0;for(let o=s;o<t.numOfRows+s;o++)n.tbody.insertBefore(t.rowNode[e].element,n.tbody.children[o]),e++}for(let e=s;e<n.rows.length;e++)n.rows[e].y=e;for(let e=s;e<n.records.length;e++)for(let t=0;t<n.records[e].length;t++)n.records[e][t].y=e;n.options.pagination>0&&n.page(n.pageNumber),l.ec.call(n)},d=function(e,t){const n=this,s=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){const e=t.numOfColumns;n.options.columns.splice(s,e);for(let t=s;t<e+s;t++)n.headers[t].parentNode.removeChild(n.headers[t]),n.cols[t].colElement.parentNode.removeChild(n.cols[t].colElement);n.headers.splice(s,e),n.cols.splice(s,e);for(let o=0;o<t.data.length;o++){for(let t=s;t<e+s;t++)n.records[o][t].element.parentNode.removeChild(n.records[o][t].element);n.records[o].splice(s,e),n.options.data[o].splice(s,e)}if(n.options.footers)for(let t=0;t<n.options.footers.length;t++)n.options.footers[t].splice(s,e)}else{n.options.columns=(0,o.Wc)(n.options.columns,s,t.columns),n.headers=(0,o.Wc)(n.headers,s,t.headers),n.cols=(0,o.Wc)(n.cols,s,t.cols);let e=0;for(let o=s;o<t.numOfColumns+s;o++)n.headerContainer.insertBefore(t.headers[e],n.headerContainer.children[o+1]),n.colgroupContainer.insertBefore(t.cols[e].colElement,n.colgroupContainer.children[o+1]),e++;for(let e=0;e<t.data.length;e++){n.options.data[e]=(0,o.Wc)(n.options.data[e],s,t.data[e]),n.records[e]=(0,o.Wc)(n.records[e],s,t.records[e]);let l=0;for(let o=s;o<t.numOfColumns+s;o++)n.rows[e].element.insertBefore(t.records[e][l].element,n.rows[e].element.children[o+1]),l++}if(n.options.footers)for(let e=0;e<n.options.footers.length;e++)n.options.footers[e]=(0,o.Wc)(n.options.footers[e],s,t.footers[e])}for(let e=s;e<n.cols.length;e++)n.cols[e].x=e;for(let e=0;e<n.records.length;e++)for(let t=s;t<n.records[e].length;t++)n.records[e][t].x=t;if(n.options.nestedHeaders&&n.options.nestedHeaders.length>0&&n.options.nestedHeaders[0]&&n.options.nestedHeaders[0][0])for(let s=0;s<n.options.nestedHeaders.length;s++){let o;o=1==e?parseInt(n.options.nestedHeaders[s][n.options.nestedHeaders[s].length-1].colspan)-t.numOfColumns:parseInt(n.options.nestedHeaders[s][n.options.nestedHeaders[s].length-1].colspan)+t.numOfColumns,n.options.nestedHeaders[s][n.options.nestedHeaders[s].length-1].colspan=o,n.thead.children[s].children[n.thead.children[s].children.length-1].setAttribute("colspan",o)}l.ec.call(n)},p=function(){const e=this,t=!!e.parent.ignoreEvents,n=!!e.ignoreHistory;e.parent.ignoreEvents=!0,e.ignoreHistory=!0;const o=[];let l;if(e.historyIndex>=0)if(l=e.history[e.historyIndex--],"insertRow"==l.action)u.call(e,1,l);else if("deleteRow"==l.action)u.call(e,0,l);else if("insertColumn"==l.action)d.call(e,1,l);else if("deleteColumn"==l.action)d.call(e,0,l);else if("moveRow"==l.action)e.moveRow(l.newValue,l.oldValue);else if("moveColumn"==l.action)e.moveColumn(l.newValue,l.oldValue);else if("setMerge"==l.action)e.removeMerge(l.column,l.data);else if("setStyle"==l.action)e.setStyle(l.oldValue,null,null,1);else if("setWidth"==l.action)e.setWidth(l.column,l.oldValue);else if("setHeight"==l.action)e.setHeight(l.row,l.oldValue);else if("setHeader"==l.action)e.setHeader(l.column,l.oldValue);else if("setComments"==l.action)e.setComments(l.oldValue);else if("orderBy"==l.action){let t=[];for(let e=0;e<l.rows.length;e++)t[l.rows[e]]=e;i.SV.call(e,l.column,l.order?0:1),i.Cs.call(e,t)}else if("setValue"==l.action){for(let t=0;t<l.records.length;t++)o.push({x:l.records[t].x,y:l.records[t].y,value:l.records[t].oldValue}),l.oldStyle&&e.resetStyle(l.oldStyle);e.setValue(o),l.selection&&e.updateSelectionFromCoords(l.selection[0],l.selection[1],l.selection[2],l.selection[3])}e.parent.ignoreEvents=t,e.ignoreHistory=n,s.Z.call(e,"onundo",e,l)},h=function(){const e=this,t=!!e.parent.ignoreEvents,n=!!e.ignoreHistory;let o;if(e.parent.ignoreEvents=!0,e.ignoreHistory=!0,e.historyIndex<e.history.length-1)if(o=e.history[++e.historyIndex],"insertRow"==o.action)u.call(e,0,o);else if("deleteRow"==o.action)u.call(e,1,o);else if("insertColumn"==o.action)d.call(e,0,o);else if("deleteColumn"==o.action)d.call(e,1,o);else if("moveRow"==o.action)e.moveRow(o.oldValue,o.newValue);else if("moveColumn"==o.action)e.moveColumn(o.oldValue,o.newValue);else if("setMerge"==o.action)r.mt.call(e,o.column,o.colspan,o.rowspan,1);else if("setStyle"==o.action)e.setStyle(o.newValue,null,null,1);else if("setWidth"==o.action)e.setWidth(o.column,o.newValue);else if("setHeight"==o.action)e.setHeight(o.row,o.newValue);else if("setHeader"==o.action)e.setHeader(o.column,o.newValue);else if("setComments"==o.action)e.setComments(o.newValue);else if("orderBy"==o.action)i.SV.call(e,o.column,o.order),i.Cs.call(e,o.rows);else if("setValue"==o.action){e.setValue(o.records);for(let t=0;t<o.records.length;t++)o.oldStyle&&e.resetStyle(o.newStyle);o.selection&&e.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}e.parent.ignoreEvents=t,e.ignoreHistory=n,s.Z.call(e,"onredo",e,o)}},992:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$S:function(){return getCell},E2:function(){return updateFormula},Gr:function(){return fullscreen},H2:function(){return parseValue},Hf:function(){return getWorksheetInstance},Of:function(){return updateScroll},Sl:function(){return getCellFromCoords},T0:function(){return updateTable},TO:function(){return hideIndex},UI:function(){return showIndex},UQ:function(){return createNestedHeader},Vi:function(){return getMask},X0:function(){return getWorksheetActive},Zz:function(){return updateFormulaChain},cW:function(){return updateResult},ec:function(){return updateTableReferences},id:function(){return getLabel},jr:function(){return isFormula},kE:function(){return createCell},pX:function(){return executeFormula},wW:function(){return updateCell}});var _dispatch_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(100),_selection_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(366),_helpers_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(650),_meta_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(272),_freeze_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(157),_pagination_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(673),_footer_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(427),_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(323);const updateTable=function(){const e=this;if(e.options.minSpareRows>0){let t=0;for(let n=e.rows.length-1;n>=0;n--){let s=!1;for(let t=0;t<e.headers.length;t++)e.options.data[n][t]&&(s=!0);if(s)break;t++}e.options.minSpareRows-t>0&&e.insertRow(e.options.minSpareRows-t)}if(e.options.minSpareCols>0){let t=0;for(let n=e.headers.length-1;n>=0;n--){let s=!1;for(let t=0;t<e.rows.length;t++)e.options.data[t][n]&&(s=!0);if(s)break;t++}e.options.minSpareCols-t>0&&e.insertColumn(e.options.minSpareCols-t)}e.options.footers&&_footer_js__WEBPACK_IMPORTED_MODULE_0__.i.call(e),setTimeout((function(){_selection_js__WEBPACK_IMPORTED_MODULE_1__.x8.call(e)}),0)},parseNumber=function(e,t){const n=t&&this.options.columns[t].decimal?this.options.columns[t].decimal:".";let s=""+e;return s=s.split(n),s[0]=s[0].match(/[+-]?[0-9]/g),s[0]&&(s[0]=s[0].join("")),s[1]&&(s[1]=s[1].match(/[0-9]*/g).join("")),s[0]&&Number.isInteger(Number(s[0]))?s[1]?Number(s[0]+"."+s[1]):Number(s[0]+".00"):null},executeFormula=function(expression,x,y){const obj=this,formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){const parentId=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;const tokensUpdate=function(e){for(let t=0;t<e.length;t++){const n=[],s=e[t].split(":"),o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(s[0],!0),l=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(s[1],!0);let r,i,c,a;o[0]<=l[0]?(r=o[0],i=l[0]):(r=l[0],i=o[0]),o[1]<=l[1]?(c=o[1],a=l[1]):(c=l[1],a=o[1]);for(let e=c;e<=a;e++)for(let t=r;t<=i;t++)n.push((0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([t,e]));expression=expression.replace(e[t],n.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");let tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";{const formulaExpressions={};if(tokens)for(let i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){const e=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(tokens[i],1);let t;if(t=void 0!==obj.options.data[e[1]]&&void 0!==obj.options.data[e[1]][e[0]]?obj.options.data[e[1]][e[0]]:"","="==(""+t).substr(0,1)&&(void 0!==formulaResults[tokens[i]]?t=formulaResults[tokens[i]]:(t=execute(t,e[0],e[1]),formulaResults[tokens[i]]=t)),""==(""+t).trim())formulaExpressions[tokens[i]]=null;else if(t==Number(t)&&0!=obj.parent.config.autoCasting)formulaExpressions[tokens[i]]=Number(t);else{const n=parseNumber.call(obj,t,e[0]);0!=obj.parent.config.autoCasting&&n?formulaExpressions[tokens[i]]=n:formulaExpressions[tokens[i]]='"'+t+'"'}}const ret=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(obj,"onbeforeformula",obj,expression,x,y);if(!1===ret)return expression;let res;ret&&(expression=ret);try{res=formula(expression.substr(1),formulaExpressions,x,y,obj),"function"==typeof res&&(res="#ERROR")}catch(e){res="#ERROR",!0===obj.parent.config.debugFormulas&&console.log(expression.substr(1),formulaExpressions,e)}return res}};return execute(expression,x,y)},parseValue=function(e,t,n,s){const o=this;"="==(""+n).substr(0,1)&&0!=o.parent.config.parseFormulas&&(n=executeFormula.call(o,n,e,t));const l=o.options.columns&&o.options.columns[e];if(l&&!isFormula(n)){let e=null;if(e=getMask(l)){n&&n==Number(n)&&(n=Number(n));let t=jSuites.mask.render(n,e,!0);if(s&&e.mask){const o=e.mask.split(";");o[1]&&(o[1].match(new RegExp("\\[Red\\]","gi"))&&(n<0?s.classList.add("red"):s.classList.remove("red")),o[1].match(new RegExp("\\(","gi"))&&n<0&&(t="("+t+")"))}t&&(n=t)}}return n},getDropDownValue=function(e,t){const n=this,s=[];if(n.options.columns&&n.options.columns[e]&&n.options.columns[e].source){const o=[],l=n.options.columns[e].source;for(let e=0;e<l.length;e++)"object"==typeof l[e]?o[l[e].id]=l[e].name:o[l[e]]=l[e];const r=Array.isArray(t)?t:(""+t).split(";");for(let e=0;e<r.length;e++)"object"==typeof r[e]?s.push(o[r[e].id]):o[r[e]]&&s.push(o[r[e]])}else console.error("Invalid column");return s.length>0?s.join("; "):""},validDate=function(e){return"-"==(e=""+e).substr(4,1)&&"-"==e.substr(7,1)||4==(e=e.split("-"))[0].length&&e[0]==Number(e[0])&&2==e[1].length&&e[1]==Number(e[1])},stripScript=function(e){const t=new Option;t.innerHTML=e;let n=null;for(e=t.getElementsByTagName("script");n=e[0];)n.parentNode.removeChild(n);return t.innerHTML},createCell=function(e,t,n){const s=this;let o=document.createElement("td");if(o.setAttribute("data-x",e),o.setAttribute("data-y",t),"="==(""+n).substr(0,1)&&1==s.options.secureFormulas){const e=secureFormula(n);e!=n&&(n=e)}if(s.options.columns&&s.options.columns[e]&&"object"==typeof s.options.columns[e].type)!0===s.parent.config.parseHTML?o.innerHTML=n:o.textContent=n,"function"==typeof s.options.columns[e].type.createCell&&s.options.columns[e].type.createCell(o,n,parseInt(e),parseInt(t),s,s.options.columns[e]);else if(s.options.columns&&s.options.columns[e]&&"hidden"==s.options.columns[e].type)o.style.display="none",o.textContent=n;else if(s.options.columns&&s.options.columns[e]&&("checkbox"==s.options.columns[e].type||"radio"==s.options.columns[e].type)){const l=document.createElement("input");l.type=s.options.columns[e].type,l.name="c"+e,l.checked=1==n||1==n||"true"==n,l.onclick=function(){s.setValue(o,this.checked)},1!=s.options.columns[e].readOnly&&0!=s.options.editable||l.setAttribute("disabled","disabled"),o.appendChild(l),s.options.data[t][e]=l.checked}else if(s.options.columns&&s.options.columns[e]&&"calendar"==s.options.columns[e].type){let t=null;if(!validDate(n)){const o=jSuites.calendar.extractDateFromString(n,s.options.columns[e].options&&s.options.columns[e].options.format||"YYYY-MM-DD");o&&(t=o)}o.textContent=jSuites.calendar.getDateString(t||n,s.options.columns[e].options&&s.options.columns[e].options.format)}else if(s.options.columns&&s.options.columns[e]&&"dropdown"==s.options.columns[e].type)o.classList.add("jss_dropdown"),o.textContent=getDropDownValue.call(s,e,n);else if(s.options.columns&&s.options.columns[e]&&"color"==s.options.columns[e].type)if("square"==s.options.columns[e].render){const e=document.createElement("div");e.className="color",e.style.backgroundColor=n,o.appendChild(e)}else o.style.color=n,o.textContent=n;else if(s.options.columns&&s.options.columns[e]&&"image"==s.options.columns[e].type){if(n&&"data:image"==n.substr(0,10)){const e=document.createElement("img");e.src=n,o.appendChild(e)}}else s.options.columns&&s.options.columns[e]&&"html"==s.options.columns[e].type||!0===s.parent.config.parseHTML?o.innerHTML=stripScript(parseValue.call(this,e,t,n,o)):o.textContent=parseValue.call(this,e,t,n,o);s.options.columns&&s.options.columns[e]&&1==s.options.columns[e].readOnly&&(o.className="readonly");const l=s.options.columns&&s.options.columns[e]&&s.options.columns[e].align||s.options.defaultColAlign||"center";return o.style.textAlign=l,s.options.columns&&s.options.columns[e]&&0==s.options.columns[e].wordWrap||!(1==s.options.wordWrap||s.options.columns&&s.options.columns[e]&&1==s.options.columns[e].wordWrap||o.innerHTML.length>200)||(o.style.whiteSpace="pre-wrap"),e>0&&1==this.options.textOverflow&&(n||o.innerHTML?s.records[t][e-1].element.style.overflow="hidden":e==s.options.columns.length-1&&(o.style.overflow="hidden")),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(s,"oncreatecell",s,o,e,t,n),o},updateCell=function(e,t,n,s){const o=this;let l;if(1!=o.records[t][e].element.classList.contains("readonly")||s){if("="==(""+n).substr(0,1)&&1==o.options.secureFormulas){const e=secureFormula(n);e!=n&&(n=e)}const s=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(o,"onbeforechange",o,o.records[t][e].element,e,t,n);if(null!=s&&(n=s),o.options.columns&&o.options.columns[e]&&"object"==typeof o.options.columns[e].type&&"function"==typeof o.options.columns[e].type.updateCell){const s=o.options.columns[e].type.updateCell(o.records[t][e].element,n,parseInt(e),parseInt(t),o,o.options.columns[e]);void 0!==s&&(n=s)}l={x:e,y:t,col:e,row:t,value:n,oldValue:o.options.data[t][e]};let r=o.options.columns&&o.options.columns[e]&&"object"==typeof o.options.columns[e].type?o.options.columns[e].type:null;if(r)o.options.data[t][e]=n,"function"==typeof r.setValue&&r.setValue(o.records[t][e].element,n);else if(o.options.columns&&o.options.columns[e]&&("checkbox"==o.options.columns[e].type||"radio"==o.options.columns[e].type)){if("radio"==o.options.columns[e].type)for(let t=0;t<o.options.data.length;t++)o.options.data[t][e]=!1;o.records[t][e].element.children[0].checked=1==n||1==n||"true"==n||"TRUE"==n,o.options.data[t][e]=o.records[t][e].element.children[0].checked}else if(o.options.columns&&o.options.columns[e]&&"dropdown"==o.options.columns[e].type)o.options.data[t][e]=n,o.records[t][e].element.textContent=getDropDownValue.call(o,e,n);else if(o.options.columns&&o.options.columns[e]&&"calendar"==o.options.columns[e].type){let s=null;if(!validDate(n)){const t=jSuites.calendar.extractDateFromString(n,o.options.columns[e].options&&o.options.columns[e].options.format||"YYYY-MM-DD");t&&(s=t)}o.options.data[t][e]=n,o.records[t][e].element.textContent=jSuites.calendar.getDateString(s||n,o.options.columns[e].options&&o.options.columns[e].options.format)}else if(o.options.columns&&o.options.columns[e]&&"color"==o.options.columns[e].type)if(o.options.data[t][e]=n,"square"==o.options.columns[e].render){const s=document.createElement("div");s.className="color",s.style.backgroundColor=n,o.records[t][e].element.textContent="",o.records[t][e].element.appendChild(s)}else o.records[t][e].element.style.color=n,o.records[t][e].element.textContent=n;else if(o.options.columns&&o.options.columns[e]&&"image"==o.options.columns[e].type){if(n=""+n,o.options.data[t][e]=n,o.records[t][e].element.innerHTML="",n&&"data:image"==n.substr(0,10)){const s=document.createElement("img");s.src=n,o.records[t][e].element.appendChild(s)}}else o.options.data[t][e]=n,o.options.columns&&o.options.columns[e]&&"html"==o.options.columns[e].type?o.records[t][e].element.innerHTML=stripScript(parseValue.call(o,e,t,n)):!0===o.parent.config.parseHTML?o.records[t][e].element.innerHTML=stripScript(parseValue.call(o,e,t,n,o.records[t][e].element)):o.records[t][e].element.textContent=parseValue.call(o,e,t,n,o.records[t][e].element),o.options.columns&&o.options.columns[e]&&0==o.options.columns[e].wordWrap||!(1==o.options.wordWrap||o.options.columns&&o.options.columns[e]&&1==o.options.columns[e].wordWrap||o.records[t][e].element.innerHTML.length>200)?o.records[t][e].element.style.whiteSpace="":o.records[t][e].element.style.whiteSpace="pre-wrap";e>0&&(o.records[t][e-1].element.style.overflow=n?"hidden":""),o.options.columns&&o.options.columns[e]&&"function"==typeof o.options.columns[e].render&&o.options.columns[e].render(o.records[t]&&o.records[t][e]?o.records[t][e].element:null,n,parseInt(e),parseInt(t),o,o.options.columns[e]),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(o,"onchange",o,o.records[t]&&o.records[t][e]?o.records[t][e].element:null,e,t,n,l.oldValue)}else l={x:e,y:t,col:e,row:t};return l},isFormula=function(e){const t=(""+e)[0];return"="==t||"#"==t},getMask=function(e){if(e.format||e.mask||e.locale){const t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},secureFormula=function(e){let t="",n=0;for(let s=0;s<e.length;s++)'"'==e[s]&&(n=0==n?1:0),t+=1==n?e[s]:e[s].toUpperCase();return t};let chainLoopProtection=[];const updateFormulaChain=function(e,t,n){const s=this,o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([e,t]);if(s.formula[o]&&s.formula[o].length>0)if(chainLoopProtection[o])s.records[t][e].element.innerHTML="#ERROR",s.formula[o]="";else{chainLoopProtection[o]=!0;for(let e=0;e<s.formula[o].length;e++){const t=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(s.formula[o][e],!0),l=""+s.options.data[t[1]][t[0]];"="==l.substr(0,1)?n.push(updateCell.call(s,t[0],t[1],l,!0)):Object.keys(s.formula)[e]=null,updateFormulaChain.call(s,t[0],t[1],n)}}chainLoopProtection=[]},updateFormula=function(e,t){const n=/[A-Z]/,s=/[0-9]/;let o="",l=null,r=null,i="";for(let c=0;c<e.length;c++)n.exec(e[c])?(l=1,r=0,i+=e[c]):s.exec(e[c])?(r=l?1:0,i+=e[c]):(l&&r&&(i=t[i]?t[i]:i),o+=i,o+=e[c],l=0,r=0,i="");return i&&(l&&r&&(i=t[i]?t[i]:i),o+=i),o},updateFormulas=function(e){const t=this;for(let n=0;n<t.options.data.length;n++)for(let s=0;s<t.options.data[0].length;s++){const o=""+t.options.data[n][s];if("="==o.substr(0,1)){const l=updateFormula(o,e);l!=o&&(t.options.data[n][s]=l)}}const n=[],s=Object.keys(t.formula);for(let o=0;o<s.length;o++){let l=s[o];const r=t.formula[l];e[l]&&(l=e[l]),n[l]=[];for(let t=0;t<r.length;t++){let s=r[t];e[s]&&(s=e[s]),n[l].push(s)}}t.formula=n},updateTableReferences=function(){const e=this;for(let t=0;t<e.headers.length;t++)e.headers[t].getAttribute("data-x")!=t&&(e.headers[t].setAttribute("data-x",t),e.headers[t].getAttribute("title")||(e.headers[t].innerHTML=(0,_helpers_js__WEBPACK_IMPORTED_MODULE_4__.getColumnName)(t)));for(let t=0;t<e.rows.length;t++)e.rows[t]&&e.rows[t].element.getAttribute("data-y")!=t&&(e.rows[t].element.setAttribute("data-y",t),e.rows[t].element.children[0].setAttribute("data-y",t),e.rows[t].element.children[0].innerHTML=t+1);const t=[],n=[],s=function(n,s,o,l){if(n!=o&&e.records[l][o].element.setAttribute("data-x",o),s!=l&&e.records[l][o].element.setAttribute("data-y",l),n!=o||s!=l){const e=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([n,s]),r=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([o,l]);t[e]=r}};for(let t=0;t<e.records.length;t++)for(let o=0;o<e.records[0].length;o++)if(e.records[t][o]){const l=e.records[t][o].element.getAttribute("data-x"),r=e.records[t][o].element.getAttribute("data-y");if(e.records[t][o].element.getAttribute("data-merged")){const e=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([l,r]),s=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([o,t]);if(null==n[e])if(e==s)n[e]=!1;else{const i=parseInt(o-l),c=parseInt(t-r);n[e]=[s,i,c]}}else s(l,r,o,t)}const o=Object.keys(n);if(o.length)for(let t=0;t<o.length;t++)if(n[o[t]]){const l=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(o[t],!0);let r=l[0],i=l[1];s(r,i,r+n[o[t]][1],i+n[o[t]][2]);const c=o[t],a=n[o[t]][0];for(let s=0;s<e.options.mergeCells[c][2].length;s++)r=parseInt(e.options.mergeCells[c][2][s].getAttribute("data-x")),i=parseInt(e.options.mergeCells[c][2][s].getAttribute("data-y")),e.options.mergeCells[c][2][s].setAttribute("data-x",r+n[o[t]][1]),e.options.mergeCells[c][2][s].setAttribute("data-y",i+n[o[t]][2]);e.options.mergeCells[a]=e.options.mergeCells[c],delete e.options.mergeCells[c]}updateFormulas.call(e,t),_meta_js__WEBPACK_IMPORTED_MODULE_5__.Lx.call(e,t),_selection_js__WEBPACK_IMPORTED_MODULE_1__.E.call(e),updateTable.call(e)},updateScroll=function(e){const t=this,n=t.content.getBoundingClientRect(),s=n.left,o=n.top,l=n.width,r=n.height,i=t.records[t.selectedCell[3]][t.selectedCell[2]].element.getBoundingClientRect(),c=i.left,a=i.top,u=i.width,d=i.height;let p,h;0==e||1==e?(p=c-s+t.content.scrollLeft,h=a-o+t.content.scrollTop-2):(p=c-s+t.content.scrollLeft+u,h=a-o+t.content.scrollTop+d),h>t.content.scrollTop+30&&h<t.content.scrollTop+r||(h<t.content.scrollTop+30?t.content.scrollTop=h-d:t.content.scrollTop=h-(r-2));const m=_freeze_js__WEBPACK_IMPORTED_MODULE_6__.I.call(t);p>t.content.scrollLeft+m&&p<t.content.scrollLeft+l||(p<t.content.scrollLeft+30?(t.content.scrollLeft=p,t.content.scrollLeft<50&&(t.content.scrollLeft=0)):p<t.content.scrollLeft+m?t.content.scrollLeft=p-m-1:t.content.scrollLeft=p-(l-20))},updateResult=function(){const e=this;let t=0,n=0;for(t=1==e.options.lazyLoading?100:e.options.pagination>0?e.options.pagination:e.results?e.results.length:e.rows.length;e.tbody.firstChild;)e.tbody.removeChild(e.tbody.firstChild);for(let s=0;s<e.rows.length;s++)!e.results||e.results.indexOf(s)>-1?(n<t&&(e.tbody.appendChild(e.rows[s].element),n++),e.rows[s].element.style.display=""):e.rows[s].element.style.display="none";return e.options.pagination>0&&_pagination_js__WEBPACK_IMPORTED_MODULE_7__.Ik.call(e),_selection_js__WEBPACK_IMPORTED_MODULE_1__.x8.call(e),t},getCell=function(e,t){if("string"==typeof e){const n=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(e,!0);e=n[0],t=n[1]}return this.records[t][e].element},getCellFromCoords=function(e,t){return this.records[t][e].element},getLabel=function(e,t){if("string"==typeof e){const n=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(e,!0);e=n[0],t=n[1]}return this.records[t][e].element.innerHTML},fullscreen=function(e){const t=this;null==e&&(e=!t.config.fullscreen),t.config.fullscreen!=e&&(t.config.fullscreen=e,1==e?t.element.classList.add("fullscreen"):t.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(e){const t=this,n=document.createElement("tr");n.classList.add("jss_nested");const s=document.createElement("td");s.classList.add("jss_selectall"),n.appendChild(s),e.element=n;let o=0;for(let s=0;s<e.length;s++){e[s].colspan||(e[s].colspan=1),e[s].title||(e[s].title=""),e[s].id||(e[s].id="");let l=e[s].colspan;const r=[];for(let e=0;e<l;e++)t.options.columns[o]&&"hidden"==t.options.columns[o].type&&l++,r.push(o),o++;const i=document.createElement("td");i.setAttribute("data-column",r.join(",")),i.setAttribute("colspan",e[s].colspan),i.setAttribute("align",e[s].align||"center"),i.setAttribute("id",e[s].id),i.textContent=e[s].title,n.appendChild(i)}return n},getWorksheetActive=function(){const e=this.parent?this.parent:this;return e.element.tabs?e.element.tabs.getActive():0},getWorksheetInstance=function(e){const t=void 0!==e?e:getWorksheetActive.call(this);return this.worksheets[t]}},323:function(e,t,n){n.d(t,{Ar:function(){return r},Wc:function(){return o},qP:function(){return l}});var s=n(650);const o=function(e,t,n){if(t<=e.length)return e.slice(0,t).concat(n).concat(e.slice(t));const s=e.slice(0,e.length);for(;t>s.length;)s.push(void 0);return s.concat(n)},l=function(e,t){const n=/^[a-zA-Z]+/.exec(e);if(n){let s=0;for(let e=0;e<n[0].length;e++)s+=parseInt(n[0].charCodeAt(e)-64)*Math.pow(26,n[0].length-1-e);s--,s<0&&(s=0);let o=parseInt(/[0-9]+$/.exec(e));o>0&&o--,e=1==t?[s,o]:s+"-"+o}return e},r=function(e){return Array.isArray(e)||(e=e.split("-")),(0,s.getColumnName)(parseInt(e[0]))+(parseInt(e[1])+1)}},665:function(e,t,n){n.d(t,{Kw:function(){return l},VG:function(){return r},ij:function(){return s},iw:function(){return o}});const s=function(e){const t=this;let n;n=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows:t.results;const s=100;null!=e&&-1!=e||(e=Math.ceil(n.length/s)-1);let o=e*s,l=e*s+s;l>n.length&&(l=n.length),o=l-100,o<0&&(o=0);for(let e=o;e<l;e++)1!=t.options.search&&1!=t.options.filters||!t.results?t.tbody.appendChild(t.rows[e].element):t.tbody.appendChild(t.rows[n[e]].element),t.tbody.children.length>s&&t.tbody.removeChild(t.tbody.firstChild)},o=function(){const e=this;if(e.selectedCell){const t=parseInt(e.tbody.firstChild.getAttribute("data-y"))/100,n=parseInt(e.selectedCell[3]/100),s=parseInt(e.rows.length/100);if(t!=n&&n<=s&&!Array.prototype.indexOf.call(e.tbody.children,e.rows[e.selectedCell[3]].element))return e.loadPage(n),!0}return!1},l=function(){const e=this;let t;t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows:e.results;let n=0;if(t.length>100){let s=parseInt(e.tbody.firstChild.getAttribute("data-y"));if(1!=e.options.search&&1!=e.options.filters||!e.results||(s=t.indexOf(s)),s>0)for(let o=0;o<30;o++)s-=1,s>-1&&(1!=e.options.search&&1!=e.options.filters||!e.results?e.tbody.insertBefore(e.rows[s].element,e.tbody.firstChild):e.tbody.insertBefore(e.rows[t[s]].element,e.tbody.firstChild),e.tbody.children.length>100&&(e.tbody.removeChild(e.tbody.lastChild),n=1))}return n},r=function(){const e=this;let t;t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows:e.results;let n=0;if(t.length>100){let s=parseInt(e.tbody.lastChild.getAttribute("data-y"));if(1!=e.options.search&&1!=e.options.filters||!e.results||(s=t.indexOf(s)),s<e.rows.length-1)for(let o=0;o<=30;o++)s<t.length&&(1!=e.options.search&&1!=e.options.filters||!e.results?e.tbody.appendChild(e.rows[s].element):e.tbody.appendChild(e.rows[t[s]].element),e.tbody.children.length>100&&(e.tbody.removeChild(e.tbody.firstChild),n=1)),s+=1}return n}},49:function(e,t,n){n.d(t,{D0:function(){return c},D8:function(){return u},Vg:function(){return p},mt:function(){return d},q4:function(){return a},tW:function(){return h}});var s=n(323),o=n(992),l=n(923),r=n(100),i=n(366);const c=function(e,t){const n=this,o=[];if(n.options.mergeCells){const l=Object.keys(n.options.mergeCells);for(let r=0;r<l.length;r++){const i=(0,s.qP)(l[r],!0),c=n.options.mergeCells[l[r]][0],a=i[0],u=i[0]+(c>1?c-1:0);null==t?a<=e&&u>=e&&o.push(l[r]):t?a<e&&u>=e&&o.push(l[r]):a<=e&&u>e&&o.push(l[r])}}return o},a=function(e,t){const n=this,o=[];if(n.options.mergeCells){const l=Object.keys(n.options.mergeCells);for(let r=0;r<l.length;r++){const i=(0,s.qP)(l[r],!0),c=n.options.mergeCells[l[r]][1],a=i[1],u=i[1]+(c>1?c-1:0);null==t?a<=e&&u>=e&&o.push(l[r]):t?a<e&&u>=e&&o.push(l[r]):a<=e&&u>e&&o.push(l[r])}}return o},u=function(e){const t=this;let n={};if(e)n=t.options.mergeCells&&t.options.mergeCells[e]?[t.options.mergeCells[e][0],t.options.mergeCells[e][1]]:null;else if(t.options.mergeCells){t.options.mergeCells;const e=Object.keys(t.options.mergeCells);for(let s=0;s<e.length;s++)n[e[s]]=[t.options.mergeCells[e[s]][0],t.options.mergeCells[e[s]][1]]}return n},d=function(e,t,n,c){const a=this;let u=!1;if(e){if("string"!=typeof e)return null}else{if(!a.highlighted.length)return alert(jSuites.translate("No cells selected")),null;{const o=parseInt(a.highlighted[0].getAttribute("data-x")),l=parseInt(a.highlighted[0].getAttribute("data-y")),r=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-x")),i=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-y"));e=(0,s.Ar)([o,l]),t=r-o+1,n=i-l+1}}const d=(0,s.qP)(e,!0);if(a.options.mergeCells&&a.options.mergeCells[e])a.records[d[1]][d[0]].element.getAttribute("data-merged")&&(u="Cell already merged");else if((!t||t<2)&&(!n||n<2))u="Invalid merged properties";else for(let e=d[1];e<d[1]+n;e++)for(let n=d[0];n<d[0]+t;n++)(0,s.Ar)([n,e]),a.records[e][n].element.getAttribute("data-merged")&&(u="There is a conflict with another merged cell");if(u)alert(jSuites.translate(u));else{t>1?a.records[d[1]][d[0]].element.setAttribute("colspan",t):t=1,n>1?a.records[d[1]][d[0]].element.setAttribute("rowspan",n):n=1,a.options.mergeCells||(a.options.mergeCells={}),a.options.mergeCells[e]=[t,n,[]],a.records[d[1]][d[0]].element.setAttribute("data-merged","true"),a.records[d[1]][d[0]].element.style.overflow="hidden";const s=[];for(let l=d[1];l<d[1]+n;l++)for(let n=d[0];n<d[0]+t;n++)d[0]==n&&d[1]==l||(s.push(a.options.data[l][n]),o.wW.call(a,n,l,"",!0),a.options.mergeCells[e][2].push(a.records[l][n].element),a.records[l][n].element.style.display="none",a.records[l][n].element=a.records[d[1]][d[0]].element);i.e3.call(a,a.records[d[1]][d[0]].element),c||(l.JB.call(a,{action:"setMerge",column:e,colspan:t,rowspan:n,data:s}),r.Z.call(a,"onmerge",a,{[e]:[t,n]}))}},p=function(e,t,n){const l=this;if(l.options.mergeCells&&l.options.mergeCells[e]){const r=(0,s.qP)(e,!0);l.records[r[1]][r[0]].element.removeAttribute("colspan"),l.records[r[1]][r[0]].element.removeAttribute("rowspan"),l.records[r[1]][r[0]].element.removeAttribute("data-merged");const c=l.options.mergeCells[e];let a,u,d=0;for(a=0;a<c[1];a++)for(u=0;u<c[0];u++)(a>0||u>0)&&(l.records[r[1]+a][r[0]+u].element=c[2][d],l.records[r[1]+a][r[0]+u].element.style.display="",t&&t[d]&&o.wW.call(l,r[0]+u,r[1]+a,t[d]),d++);i.e3.call(l,l.records[r[1]][r[0]].element,l.records[r[1]+a-1][r[0]+u-1].element),n||delete l.options.mergeCells[e]}},h=function(e){const t=this;if(t.options.mergeCells){t.options.mergeCells;const n=Object.keys(t.options.mergeCells);for(let s=0;s<n.length;s++)p.call(t,n[s],null,e)}}},272:function(e,t,n){n.d(t,{Lx:function(){return l},US:function(){return r},xZ:function(){return o}});var s=n(100);const o=function(e,t){const n=this;return e?t?n.options.meta&&n.options.meta[e]&&n.options.meta[e][t]?n.options.meta[e][t]:null:n.options.meta&&n.options.meta[e]?n.options.meta[e]:null:n.options.meta},l=function(e){const t=this;if(t.options.meta){const n={},s=Object.keys(t.options.meta);for(let o=0;o<s.length;o++)e[s[o]]?n[e[s[o]]]=t.options.meta[s[o]]:n[s[o]]=t.options.meta[s[o]];t.options.meta=n}},r=function(e,t,n){const o=this;if(o.options.meta||(o.options.meta={}),t&&n)o.options.meta[e]||(o.options.meta[e]={}),o.options.meta[e][t]=n,s.Z.call(o,"onchangemeta",o,{[e]:{[t]:n}});else{const t=Object.keys(e);for(let n=0;n<t.length;n++){o.options.meta[t[n]]||(o.options.meta[t[n]]={});const s=Object.keys(e[t[n]]);for(let l=0;l<s.length;l++)o.options.meta[t[n]][s[l]]=e[t[n]][s[l]]}s.Z.call(o,"onchangemeta",o,e)}}},54:function(e,t,n){n.d(t,{Cs:function(){return a},SV:function(){return c},Xo:function(){return u}});var s=n(923),o=n(100),l=n(992),r=n(665),i=n(456);const c=function(e,t){const n=this;for(let e=0;e<n.headers.length;e++)n.headers[e].classList.remove("arrow-up"),n.headers[e].classList.remove("arrow-down");t?n.headers[e].classList.add("arrow-up"):n.headers[e].classList.add("arrow-down")},a=function(e){const t=this;let n=[];for(let s=0;s<e.length;s++)n[s]=t.options.data[e[s]];t.options.data=n,n=[];for(let s=0;s<e.length;s++){n[s]=t.records[e[s]];for(let e=0;e<n[s].length;e++)n[s][e].y=s}t.records=n,n=[];for(let s=0;s<e.length;s++)n[s]=t.rows[e[s]],n[s].y=s;if(t.rows=n,l.ec.call(t),t.results&&t.results.length)t.searchInput.value?t.search(t.searchInput.value):i.ql.call(t);else if(t.results=null,t.pageNumber=0,t.options.pagination>0)t.page(0);else if(1==t.options.lazyLoading)r.ij.call(t,0);else for(let e=0;e<t.rows.length;e++)t.tbody.appendChild(t.rows[e].element)},u=function(e,t){const n=this;if(e>=0){if(n.options.mergeCells&&Object.keys(n.options.mergeCells).length>0){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;n.destroyMerge()}t=null==t?n.headers[e].classList.contains("arrow-down")?1:0:t?1:0;let l=[];if(n.options.columns&&n.options.columns[e]&&("number"==n.options.columns[e].type||"numeric"==n.options.columns[e].type||"percentage"==n.options.columns[e].type||"autonumber"==n.options.columns[e].type||"color"==n.options.columns[e].type))for(let t=0;t<n.options.data.length;t++)l[t]=[t,Number(n.options.data[t][e])];else if(n.options.columns&&n.options.columns[e]&&("calendar"==n.options.columns[e].type||"checkbox"==n.options.columns[e].type||"radio"==n.options.columns[e].type))for(let t=0;t<n.options.data.length;t++)l[t]=[t,n.options.data[t][e]];else for(let t=0;t<n.options.data.length;t++)l[t]=[t,n.records[t][e].element.textContent.toLowerCase()];"function"!=typeof n.parent.config.sorting&&(n.parent.config.sorting=function(e){return function(t,n){const s=t[1],o=n[1];return e?""===s&&""!==o?1:""!==s&&""===o||s>o?-1:s<o?1:0:""===s&&""!==o?1:""!==s&&""===o?-1:s>o?1:s<o?-1:0}}),l=l.sort(n.parent.config.sorting(t));const r=[];for(let e=0;e<l.length;e++)r[e]=l[e][0];return s.JB.call(n,{action:"orderBy",rows:r,column:e,order:t}),c.call(n,e,t),a.call(n,r),o.Z.call(n,"onsort",n,e,t,r.map((e=>e))),!0}}},673:function(e,t,n){n.d(t,{Ik:function(){return r},Md:function(){return i},an:function(){return l},ur:function(){return c}});var s=n(100),o=n(366);const l=function(e){const t=this;return 1!=t.options.search&&1!=t.options.filters||!t.results||(e=t.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(t.options.pagination))-1},r=function(){const e=this;if(e.pagination.children[0].innerHTML="",e.pagination.children[1].innerHTML="",e.options.pagination){let t;if(t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows.length:e.results.length,t){const n=Math.ceil(t/e.options.pagination);let s,o;if(e.pageNumber<6?(s=1,o=n<10?n:10):n-e.pageNumber<5?(s=n-9,o=n,s<1&&(s=1)):(s=e.pageNumber-4,o=e.pageNumber+5),s>1){const t=document.createElement("div");t.className="jss_page",t.innerHTML="<",t.title=1,e.pagination.children[1].appendChild(t)}for(let t=s;t<=o;t++){const n=document.createElement("div");n.className="jss_page",n.innerHTML=t,e.pagination.children[1].appendChild(n),e.pageNumber==t-1&&n.classList.add("jss_page_selected")}if(o<n){const t=document.createElement("div");t.className="jss_page",t.innerHTML=">",t.title=n,e.pagination.children[1].appendChild(t)}const l=function(e){const t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))};e.pagination.children[0].innerHTML=l(jSuites.translate("Showing page {0} of {1} entries"),e.pageNumber+1,n)}else e.pagination.children[0].innerHTML=jSuites.translate("No records found")}},i=function(e){const t=this,n=t.pageNumber;let l;l=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows:t.results;const i=parseInt(t.options.pagination);null!=e&&-1!=e||(e=Math.ceil(l.length/i)-1),t.pageNumber=e;let c=e*i,a=e*i+i;for(a>l.length&&(a=l.length),c<0&&(c=0);t.tbody.firstChild;)t.tbody.removeChild(t.tbody.firstChild);for(let e=c;e<a;e++)1!=t.options.search&&1!=t.options.filters||!t.results?t.tbody.appendChild(t.rows[e].element):t.tbody.appendChild(t.rows[l[e]].element);t.options.pagination>0&&r.call(t),o.x8.call(t),s.Z.call(t,"onchangepage",t,e,n,t.options.pagination)},c=function(){const e=this;let t;return t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows.length:e.results.length,Math.ceil(t/e.options.pagination)}},366:function(e,t,n){n.d(t,{E:function(){return g},Es:function(){return m},F1:function(){return j},H7:function(){return f},Mf:function(){return E},Mt:function(){return C},Uv:function(){return w},VD:function(){return L},VL:function(){return D},Ym:function(){return _},e3:function(){return p},ey:function(){return v},rx:function(){return x},td:function(){return A},vn:function(){return h},vp:function(){return b},x8:function(){return u},yE:function(){return d}});var s=n(100),o=n(157),l=n(650),r=n(923),i=n(992),c=n(323),a=n(898);const u=function(){const e=this;if(e.highlighted&&e.highlighted.length){const t=e.highlighted[e.highlighted.length-1].element,n=t.getAttribute("data-x"),s=e.content.getBoundingClientRect(),l=s.left,r=s.top,i=t.getBoundingClientRect(),c=i.left,a=i.top,u=i.width,d=i.height,p=c-l+e.content.scrollLeft+u-4,h=a-r+e.content.scrollTop+d-4;if(e.corner.style.top=h+"px",e.corner.style.left=p+"px",e.options.freezeColumns){const t=o.I.call(e);n>e.options.freezeColumns-1&&c-l+u<t?e.corner.style.display="none":0!=e.options.selectionCopy&&(e.corner.style.display="")}else 0!=e.options.selectionCopy&&(e.corner.style.display="")}else e.corner.style.top="-2000px",e.corner.style.left="-2000px";(0,a.yf)(e)},d=function(e){const t=this;let n;if(t.highlighted&&t.highlighted.length){n=1;for(let e=0;e<t.highlighted.length;e++){t.highlighted[e].element.classList.remove("highlight"),t.highlighted[e].element.classList.remove("highlight-left"),t.highlighted[e].element.classList.remove("highlight-right"),t.highlighted[e].element.classList.remove("highlight-top"),t.highlighted[e].element.classList.remove("highlight-bottom"),t.highlighted[e].element.classList.remove("highlight-selected");const n=parseInt(t.highlighted[e].element.getAttribute("data-x")),s=parseInt(t.highlighted[e].element.getAttribute("data-y"));let o,l;if(t.highlighted[e].element.getAttribute("data-merged")){const r=parseInt(t.highlighted[e].element.getAttribute("colspan")),i=parseInt(t.highlighted[e].element.getAttribute("rowspan"));o=r>0?n+(r-1):n,l=i>0?s+(i-1):s}else o=n,l=s;for(let e=n;e<=o;e++)t.headers[e]&&t.headers[e].classList.remove("selected");for(let e=s;e<=l;e++)t.rows[e]&&t.rows[e].element.classList.remove("selected")}}else n=0;return t.highlighted=[],t.selectedCell=null,t.corner.style.top="-2000px",t.corner.style.left="-2000px",1==e&&1==n&&s.Z.call(t,"onblur",t),n},p=function(e,t,n){const s=e.getAttribute("data-x"),o=e.getAttribute("data-y");let l,r;t?(l=t.getAttribute("data-x"),r=t.getAttribute("data-y")):(l=s,r=o),m.call(this,s,o,l,r,n)},h=function(){const e=document.querySelectorAll(".jss_worksheet .copying");for(let t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},m=function(e,t,n,o,l){const r=this;if(null==t){if(t=0,o=r.rows.length-1,null==e)return}else null==e&&(e=0,n=r.options.data[0].length-1);null==n&&(n=e),null==o&&(o=t),e>=r.headers.length&&(e=r.headers.length-1),t>=r.rows.length&&(t=r.rows.length-1),n>=r.headers.length&&(n=r.headers.length-1),o>=r.rows.length&&(o=r.rows.length-1);let i,c,a,d,p=null,m=null,f=null,g=null;parseInt(e)<parseInt(n)?(i=parseInt(e),c=parseInt(n)):(i=parseInt(n),c=parseInt(e)),parseInt(t)<parseInt(o)?(a=parseInt(t),d=parseInt(o)):(a=parseInt(o),d=parseInt(t));for(let e=i;e<=c;e++)for(let t=a;t<=d;t++)if(r.records[t][e]&&r.records[t][e].element.getAttribute("data-merged")){const n=parseInt(r.records[t][e].element.getAttribute("data-x")),s=parseInt(r.records[t][e].element.getAttribute("data-y")),o=parseInt(r.records[t][e].element.getAttribute("colspan")),l=parseInt(r.records[t][e].element.getAttribute("rowspan"));o>1&&(n<i&&(i=n),n+o>c&&(c=n+o-1)),l&&(s<a&&(a=s),s+l>d&&(d=s+l-1))}for(let e=a;e<=d;e++)"none"!=r.rows[e].element.style.display&&(null==f&&(f=e),g=e);for(let e=i;e<=c;e++)for(let t=a;t<=d;t++)r.options.columns&&r.options.columns[e]&&"hidden"==r.options.columns[e].type||(null==p&&(p=e),m=e);if(p||(p=0),m||(m=0),!1===s.Z.call(r,"onbeforeselection",r,p,f,m,g,l))return!1;const C=r.resetSelection();r.selectedCell=[e,t,n,o],r.records[t][e]&&r.records[t][e].element.classList.add("highlight-selected");for(let e=i;e<=c;e++)for(let t=a;t<=d;t++)"none"!=r.rows[t].element.style.display&&"none"!=r.records[t][e].element.style.display&&(r.records[t][e].element.classList.add("highlight"),r.highlighted.push(r.records[t][e]));for(let e=p;e<=m;e++)r.options.columns&&r.options.columns[e]&&"hidden"==r.options.columns[e].type||!r.cols[e].colElement.style||"none"==r.cols[e].colElement.style.display||(r.records[f]&&r.records[f][e]&&r.records[f][e].element.classList.add("highlight-top"),r.records[g]&&r.records[g][e]&&r.records[g][e].element.classList.add("highlight-bottom"),r.headers[e].classList.add("selected"));for(let e=f;e<=g;e++)r.rows[e]&&"none"!=r.rows[e].element.style.display&&(r.records[e][p].element.classList.add("highlight-left"),r.records[e][m].element.classList.add("highlight-right"),r.rows[e].element.classList.add("selected"));r.selectedContainer=[p,f,m,g],0==C&&(s.Z.call(r,"onfocus",r),h()),s.Z.call(r,"onselection",r,p,f,m,g,l),u.call(r)},f=function(e){const t=this;if(!t.selectedCell)return[];const n=[];for(let s=Math.min(t.selectedCell[0],t.selectedCell[2]);s<=Math.max(t.selectedCell[0],t.selectedCell[2]);s++)e&&"none"==t.headers[s].style.display||n.push(s);return n},g=function(){const e=this;e.selectedCell&&e.updateSelectionFromCoords(e.selectedCell[0],e.selectedCell[1],e.selectedCell[2],e.selectedCell[3])},C=function(){const e=this;for(let t=0;t<e.selection.length;t++)e.selection[t].classList.remove("selection"),e.selection[t].classList.remove("selection-left"),e.selection[t].classList.remove("selection-right"),e.selection[t].classList.remove("selection-top"),e.selection[t].classList.remove("selection-bottom");e.selection=[]},y=function(e){return 1==(e=""+e).length&&(e="0"+e),e},j=function(e,t){const n=this,o=n.getData(!0,!0),l=n.selectedContainer,a=parseInt(e.getAttribute("data-x")),u=parseInt(e.getAttribute("data-y")),d=parseInt(t.getAttribute("data-x")),p=parseInt(t.getAttribute("data-y")),h=[];let m,f,g=!1;l[0]==a?(m=u<l[1]?u-l[1]:1,f=0):(f=a<l[0]?a-l[0]:1,m=0);let C=0,j=0;for(let e=u;e<=p;e++)if(!n.rows[e]||"none"!=n.rows[e].element.style.display){null==o[j]&&(j=0),C=0,l[0]!=a&&(f=a<l[0]?a-l[0]:1);for(let t=a;t<=d;t++){if(n.records[e][t]&&!n.records[e][t].element.classList.contains("readonly")&&"none"!=n.records[e][t].element.style.display&&0==g){if(!n.selection.length&&""!=n.options.data[e][t]){g=!0;continue}(null==o[j]||null==o[j][C])&&(C=0);let s=o[j][C];if(s&&!o[1]&&0!=n.parent.config.autoIncrement)if(!n.options.columns||!n.options.columns[t]||n.options.columns[t].type&&"text"!=n.options.columns[t].type&&"number"!=n.options.columns[t].type){if(n.options.columns&&n.options.columns[t]&&"calendar"==n.options.columns[t].type){const e=new Date(s);e.setDate(e.getDate()+m),s=e.getFullYear()+"-"+y(parseInt(e.getMonth()+1))+"-"+y(e.getDate())+" 00:00:00"}}else if("="==(""+s).substr(0,1)){const e=s.match(/([A-Z]+[0-9]+)/g);if(e){const t=[];for(let n=0;n<e.length;n++){const s=(0,c.qP)(e[n],1);s[0]+=f,s[1]+=m,s[1]<0&&(s[1]=0);const o=(0,c.Ar)([s[0],s[1]]);o!=e[n]&&(t[e[n]]=o)}t&&(s=(0,i.E2)(s,t))}}else s==Number(s)&&(s=Number(s)+m);h.push(i.wW.call(n,t,e,s)),i.Zz.call(n,t,e,h)}C++,l[0]!=a&&f++}j++,m++}r.JB.call(n,{action:"setValue",records:h,selection:n.selectedCell}),i.T0.call(n);const b=h.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));s.Z.call(n,"onafterchanges",n,b)},b=function(e){let t,n,s=0;if(0===e.length)return s;for(t=0;t<e.length;t++)n=e.charCodeAt(t),s=(s<<5)-s+n,s|=0;return s},w=function(e,t,n){const s=this;if(1==e){if(s.selectedCell&&(t>=s.selectedCell[1]&&t<=s.selectedCell[3]||n>=s.selectedCell[1]&&n<=s.selectedCell[3]))return void s.resetSelection()}else if(s.selectedCell&&(t>=s.selectedCell[0]&&t<=s.selectedCell[2]||n>=s.selectedCell[0]&&n<=s.selectedCell[2]))return void s.resetSelection()},_=function(e){const t=this;if(!t.selectedCell)return[];const n=[];for(let s=Math.min(t.selectedCell[1],t.selectedCell[3]);s<=Math.max(t.selectedCell[1],t.selectedCell[3]);s++)e&&"none"==t.rows[s].element.style.display||n.push(s);return n},A=function(){const e=this;e.selectedCell||(e.selectedCell=[]),e.selectedCell[0]=0,e.selectedCell[1]=0,e.selectedCell[2]=e.headers.length-1,e.selectedCell[3]=e.records.length-1,e.updateSelectionFromCoords(e.selectedCell[0],e.selectedCell[1],e.selectedCell[2],e.selectedCell[3])},E=function(){const e=this;return e.selectedCell?[Math.min(e.selectedCell[0],e.selectedCell[2]),Math.min(e.selectedCell[1],e.selectedCell[3]),Math.max(e.selectedCell[0],e.selectedCell[2]),Math.max(e.selectedCell[1],e.selectedCell[3])]:null},v=function(e){const t=this,n=E.call(t);if(!n)return[];const s=[];for(let o=n[1];o<=n[3];o++)for(let r=n[0];r<=n[2];r++)e?s.push((0,l.getCellNameFromCoords)(r,o)):s.push(t.records[o][r]);return s},x=function(){const e=this,t=E.call(e);if(!t)return"";const n=(0,l.getCellNameFromCoords)(t[0],t[1]),s=(0,l.getCellNameFromCoords)(t[2],t[3]);return n===s?e.options.worksheetName+"!"+n:e.options.worksheetName+"!"+n+":"+s},D=function(e,t){const n=E.call(this);return e>=n[0]&&e<=n[2]&&t>=n[1]&&t<=n[3]},L=function(){const e=E.call(this);return e?[e]:[]}},898:function(e,t,n){n.d(t,{bv:function(){return u},iu:function(){return d},yf:function(){return a}});var s=n(650),o=n(992);const l=function(e,t){0!=t.options.editable?e.classList.remove("jtoolbar-disabled"):e.classList.add("jtoolbar-disabled")},r=function(){const e=[],t=this,n=function(){return o.Hf.call(t)};e.push({content:"undo",onclick:function(){n().undo()}}),e.push({content:"redo",onclick:function(){n().redo()}}),e.push({content:"save",onclick:function(){const e=n();e&&e.download()}}),e.push({type:"divisor"}),e.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},onchange:function(e,t,s,o,l){const r=n();let i=r.getSelected(!0);if(i){let e=l?o:"";r.setStyle(Object.fromEntries(i.map((function(t){return[t,"font-family: "+e]}))))}},updateState:function(e,t,s){l(s,n())}}),e.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e){return'<span style="font-size:'+e+'">'+e+"</span>"},onchange:function(e,t,s,o){const l=n();let r=l.getSelected(!0);r&&l.setStyle(Object.fromEntries(r.map((function(e){return[e,"font-size: "+o]}))))},updateState:function(e,t,s){l(s,n())}}),e.push({type:"select",options:["left","center","right","justify"],render:function(e){return'<i class="material-icons">format_align_'+e+"</i>"},onchange:function(e,t,s,o){const l=n();let r=l.getSelected(!0);r&&l.setStyle(Object.fromEntries(r.map((function(e){return[e,"text-align: "+o]}))))},updateState:function(e,t,s){l(s,n())}}),e.push({content:"format_bold",onclick:function(e,t,s){const o=n();let l=o.getSelected(!0);l&&o.setStyle(Object.fromEntries(l.map((function(e){return[e,"font-weight:bold"]}))))},updateState:function(e,t,s){l(s,n())}}),e.push({type:"color",content:"format_color_text",k:"color",updateState:function(e,t,s){l(s,n())}}),e.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(e,t,s,o){l(s,n())}});let r=["top","middle","bottom"];return e.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(e){return'<i class="material-icons">'+e+"</i>"},value:1,onchange:function(e,t,s,o,l){const i=n();let c=i.getSelected(!0);c&&i.setStyle(Object.fromEntries(c.map((function(e){return[e,"vertical-align: "+r[l]]}))))},updateState:function(e,t,s){l(s,n())}}),e.push({content:"web",tooltip:jSuites.translate("Merge the selected cells"),onclick:function(){const e=n();if(e.selectedCell&&confirm(jSuites.translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){const t=[Math.min(e.selectedCell[0],e.selectedCell[2]),Math.min(e.selectedCell[1],e.selectedCell[3]),Math.max(e.selectedCell[0],e.selectedCell[2]),Math.max(e.selectedCell[1],e.selectedCell[3])];let n=(0,s.getCellNameFromCoords)(t[0],t[1]);if(e.records[t[1]][t[0]].element.getAttribute("data-merged"))e.removeMerge(n);else{let s=t[2]-t[0]+1,o=t[3]-t[1]+1;1===s&&1===o||e.setMerge(n,s,o)}}},updateState:function(e,t,s){l(s,n())}}),e.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(e){return'<i class="material-icons">'+e+"</i>"},right:!0,onchange:function(e,t,o,l){const r=n(),i=[Math.min(r.selectedCell[0],r.selectedCell[2]),Math.min(r.selectedCell[1],r.selectedCell[3]),Math.max(r.selectedCell[0],r.selectedCell[2]),Math.max(r.selectedCell[1],r.selectedCell[3])];let c=l;if(i){let e=t.thickness||1,n=t.color||"black";const o=t.style||"solid";"double"===o&&(e+=2);let l={},a=i[0],u=i[1],d=i[2],p=i[3];const h=function(t,s,r){let i=["","","",""];i[0]=("border_top"===c||"border_outer"===c)&&r===u||("border_inner"===c||"border_horizontal"===c)&&r>u||"border_all"===c?"border-top: "+e+"px "+o+" "+n:"border-top: ",i[1]="border_all"!==c&&"border_right"!==c&&"border_outer"!==c||s!==d?"border-right: ":"border-right: "+e+"px "+o+" "+n,i[2]="border_all"!==c&&"border_bottom"!==c&&"border_outer"!==c||r!==p?"border-bottom: ":"border-bottom: "+e+"px "+o+" "+n,i[3]=("border_left"===c||"border_outer"===c)&&s===a||("border_inner"===c||"border_vertical"===c)&&s>a||"border_all"===c?"border-left: "+e+"px "+o+" "+n:"border-left: ",l[t]=i.join(";")};for(let e=i[1];e<=i[3];e++)for(let t=i[0];t<=i[2];t++)h((0,s.getCellNameFromCoords)(t,e),t,e),r.records[e][t].element.getAttribute("data-merged")&&h((0,s.getCellNameFromCoords)(i[0],i[1]),t,e);Object.keys(l)&&r.setStyle(l)}},onload:function(e,t){let n=document.createElement("div"),s=document.createElement("div");n.appendChild(s);let o=jSuites.color(s,{closeOnChange:!1,onchange:function(e,n){e.parentNode.children[1].style.color=n,t.color=n}}),l=document.createElement("i");l.classList.add("material-icons"),l.innerHTML="color_lens",l.onclick=function(){o.open()},n.appendChild(l),e.children[1].appendChild(n),s=document.createElement("div"),jSuites.picker(s,{type:"select",data:[1,2,3,4,5],render:function(e){return'<div style="height: '+e+'px; width: 30px; background-color: black;"></div>'},onchange:function(e,n,s,o){t.thickness=o},width:"50px"}),e.children[1].appendChild(s);const r=document.createElement("div");jSuites.picker(r,{type:"select",data:["solid","dotted","dashed","double"],render:function(e){return"double"===e?'<div style="width: 30px; border-top: 3px '+e+' black;"></div>':'<div style="width: 30px; border-top: 2px '+e+' black;"></div>'},onchange:function(e,n,s,o){t.style=o},width:"50px"}),e.children[1].appendChild(r),s=document.createElement("div"),s.style.flex="1",e.children[1].appendChild(s)},updateState:function(e,t,s){l(s,n())}}),e.push({type:"divisor"}),e.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(e,n,s){"fullscreen"===s.children[0].textContent?(t.fullscreen(!0),s.children[0].textContent="fullscreen_exit"):(t.fullscreen(!1),s.children[0].textContent="fullscreen")},updateState:function(e,t,n,s){!0===s.parent.config.fullscreen?n.children[0].textContent="fullscreen_exit":n.children[0].textContent="fullscreen"}}),e},i=function(e){const t=this,n=e.items;for(let e=0;e<n.length;e++)n[e].tooltip&&(n[e].title=n[e].tooltip,delete n[e].tooltip),"select"==n[e].type?n[e].options?(n[e].data=n[e].options,delete n[e].options):(n[e].data=n[e].v,delete n[e].v,n[e].k&&!n[e].onchange&&(n[e].onchange=function(s,l,r){const i=o.Hf.call(t),c=i.getSelected(!0);i.setStyle(Object.fromEntries(c.map((function(t){return[t,n[e].k+": "+r]}))))})):"color"==n[e].type&&(n[e].type="i",n[e].onclick=function(s,l,r){r.color||(jSuites.color(r,{onchange:function(s,l){const r=o.Hf.call(t),i=r.getSelected(!0);r.setStyle(Object.fromEntries(i.map((function(t){return[t,n[e].k+": "+l]}))))},onopen:function(e){e.color.select("")}}),r.color.open())})},c=function(e){const t=this,n=document.createElement("div");return n.classList.add("jss_toolbar"),i.call(t,e),"object"==typeof t.plugins&&Object.entries(t.plugins).forEach((function([,t]){if("function"==typeof t.toolbar){const n=t.toolbar(e);n&&(e=n)}})),jSuites.toolbar(n,e),n},a=function(e){e.parent.toolbar&&e.parent.toolbar.toolbar.update(e)},u=function(){const e=this;if(e.config.toolbar&&!e.toolbar){let t;Array.isArray(e.config.toolbar)?t={items:e.config.toolbar}:"object"==typeof e.config.toolbar?t=e.config.toolbar:(t={items:r.call(e)},"function"==typeof e.config.toolbar&&(t=e.config.toolbar(t))),e.toolbar=e.element.insertBefore(c.call(e,t),e.element.children[1])}},d=function(){const e=this;e.toolbar&&(e.toolbar.parentNode.removeChild(e.toolbar),delete e.toolbar)}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};!function(){__webpack_require__.d(__webpack_exports__,{default:function(){return _e}});var e={jspreadsheet:{}},t=__webpack_require__(100),n=__webpack_require__(992),s=__webpack_require__(923);const o=function(e,s,o){const r=this,i=e.getAttribute("data-y"),c=e.getAttribute("data-x");t.Z.call(r,"oneditionstart",r,e,parseInt(c),parseInt(i)),c>0&&(r.records[i][c-1].element.style.overflow="hidden");const a=function(t){const n=e.getBoundingClientRect(),s=document.createElement(t);return s.style.width=n.width+"px",s.style.height=n.height-2+"px",s.style.minHeight=n.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(s),s};if(1==e.classList.contains("readonly"));else if(r.edition=[r.records[i][c].element,r.records[i][c].element.innerHTML,c,i],r.options.columns&&r.options.columns[c]&&"object"==typeof r.options.columns[c].type)r.options.columns[c].type.openEditor(e,r.options.data[i][c],parseInt(c),parseInt(i),r,r.options.columns[c],o),t.Z.call(r,"oncreateeditor",r,e,parseInt(c),parseInt(i),null,r.options.columns[c]);else if(r.options.columns&&r.options.columns[c]&&"hidden"==r.options.columns[c].type);else if(r.options.columns&&r.options.columns[c]&&("checkbox"==r.options.columns[c].type||"radio"==r.options.columns[c].type)){const t=!e.children[0].checked;r.setValue(e,t),r.edition=null}else if(r.options.columns&&r.options.columns[c]&&"dropdown"==r.options.columns[c].type){let n,s=r.options.data[i][c];r.options.columns[c].multiple&&!Array.isArray(s)&&(s=s.split(";")),n="function"==typeof r.options.columns[c].filter?r.options.columns[c].filter(r.element,e,c,i,r.options.columns[c].source):r.options.columns[c].source;const o=[];if(n)for(let e=0;e<n.length;e++)o.push(n[e]);const u=a("div");t.Z.call(r,"oncreateeditor",r,e,parseInt(c),parseInt(i),null,r.options.columns[c]);const d={data:o,multiple:!!r.options.columns[c].multiple,autocomplete:!!r.options.columns[c].autocomplete,opened:!0,value:s,width:"100%",height:u.style.minHeight,position:1==r.options.tableOverflow||1==r.parent.config.fullscreen,onclose:function(){l.call(r,e,!0)}};r.options.columns[c].options&&r.options.columns[c].options.type&&(d.type=r.options.columns[c].options.type),jSuites.dropdown(u,d)}else if(r.options.columns&&r.options.columns[c]&&("calendar"==r.options.columns[c].type||"color"==r.options.columns[c].type)){const n=r.options.data[i][c],s=a("input");t.Z.call(r,"oncreateeditor",r,e,parseInt(c),parseInt(i),null,r.options.columns[c]),s.value=n;const o=r.options.columns[c].options?{...r.options.columns[c].options}:{};1!=r.options.tableOverflow&&1!=r.parent.config.fullscreen||(o.position=!0),o.value=r.options.data[i][c],o.opened=!0,o.onclose=function(t,n){l.call(r,e,!0)},"color"==r.options.columns[c].type?jSuites.color(s,o):(o.format||(o.format="YYYY-MM-DD"),jSuites.calendar(s,o)),s.focus()}else if(r.options.columns&&r.options.columns[c]&&"html"==r.options.columns[c].type){const n=r.options.data[i][c],s=a("div");t.Z.call(r,"oncreateeditor",r,e,parseInt(c),parseInt(i),null,r.options.columns[c]),s.style.position="relative";const o=document.createElement("div");o.classList.add("jss_richtext"),s.appendChild(o),jSuites.editor(o,{focus:!0,value:n});const l=e.getBoundingClientRect(),u=o.getBoundingClientRect();window.innerHeight<l.bottom+u.height?o.style.top=l.top-(u.height+2)+"px":o.style.top=l.top+"px"}else if(r.options.columns&&r.options.columns[c]&&"image"==r.options.columns[c].type){const n=e.children[0],s=a("div");t.Z.call(r,"oncreateeditor",r,e,parseInt(c),parseInt(i),null,r.options.columns[c]),s.style.position="relative";const o=document.createElement("div");o.classList.add("jclose"),n&&n.src&&o.appendChild(n),s.appendChild(o),jSuites.image(o,r.options.columns[c]);const l=e.getBoundingClientRect(),u=o.getBoundingClientRect();window.innerHeight<l.bottom+u.height?o.style.top=l.top-(u.height+2)+"px":o.style.top=l.top+"px"}else{const o=1==s?"":r.options.data[i][c];let u;u=r.options.columns&&r.options.columns[c]&&0==r.options.columns[c].wordWrap||!(1==r.options.wordWrap||r.options.columns&&r.options.columns[c]&&1==r.options.columns[c].wordWrap)?a("input"):a("textarea"),t.Z.call(r,"oncreateeditor",r,e,parseInt(c),parseInt(i),null,r.options.columns[c]),u.focus(),u.value=o;const d=r.options.columns&&r.options.columns[c];if(!(0,n.jr)(o)&&d){const e=(0,n.Vi)(d);if(e){if(!d.disabledMaskOnEdition)if(d.mask){const e=d.mask.split(";");u.setAttribute("data-mask",e[0])}else d.locale&&u.setAttribute("data-locale",d.locale);e.input=u,u.mask=e,jSuites.mask.render(o,e,!1)}}u.onblur=function(){l.call(r,e,!0)},u.scrollLeft=u.scrollWidth}},l=function(e,s){const o=this,l=parseInt(e.getAttribute("data-x")),r=parseInt(e.getAttribute("data-y"));let i;if(1==s){if(o.options.columns&&o.options.columns[l]&&"object"==typeof o.options.columns[l].type)i=o.options.columns[l].type.closeEditor(e,s,parseInt(l),parseInt(r),o,o.options.columns[l]);else if(o.options.columns&&o.options.columns[l]&&("checkbox"==o.options.columns[l].type||"radio"==o.options.columns[l].type||"hidden"==o.options.columns[l].type));else if(o.options.columns&&o.options.columns[l]&&"dropdown"==o.options.columns[l].type)i=e.children[0].dropdown.close(!0);else if(o.options.columns&&o.options.columns[l]&&"calendar"==o.options.columns[l].type)i=e.children[0].calendar.close(!0);else if(o.options.columns&&o.options.columns[l]&&"color"==o.options.columns[l].type)i=e.children[0].color.close(!0);else if(o.options.columns&&o.options.columns[l]&&"html"==o.options.columns[l].type)i=e.children[0].children[0].editor.getData();else if(o.options.columns&&o.options.columns[l]&&"image"==o.options.columns[l].type){const t=e.children[0].children[0].children[0];i=t&&"IMG"==t.tagName?t.src:""}else if(o.options.columns&&o.options.columns[l]&&"numeric"==o.options.columns[l].type)i=e.children[0].value,"="!=(""+i).substr(0,1)&&""==i&&(i=o.options.columns[l].allowEmpty?"":0),e.children[0].onblur=null;else{i=e.children[0].value,e.children[0].onblur=null;const t=o.options.columns&&o.options.columns[l];if(t){const e=(0,n.Vi)(t);if(e&&""!==i&&!(0,n.jr)(i)&&"number"!=typeof i){const t=jSuites.mask.extract(i,e,!0);t&&""!==t.value&&(i=t.value)}}}o.options.data[r][l]==i?e.innerHTML=o.edition[1]:o.setValue(e,i)}else o.options.columns&&o.options.columns[l]&&"object"==typeof o.options.columns[l].type?o.options.columns[l].type.closeEditor(e,s,parseInt(l),parseInt(r),o,o.options.columns[l]):o.options.columns&&o.options.columns[l]&&"dropdown"==o.options.columns[l].type?e.children[0].dropdown.close(!0):o.options.columns&&o.options.columns[l]&&"calendar"==o.options.columns[l].type?e.children[0].calendar.close(!0):o.options.columns&&o.options.columns[l]&&"color"==o.options.columns[l].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=o.edition&&o.edition[1]?o.edition[1]:"";t.Z.call(o,"oneditionend",o,e,l,r,i,s),e.classList.remove("editor"),o.edition=null},r=function(){const e=this,o=[],l=Object.keys(e.highlighted);for(let t=0;t<l.length;t++){const s=e.highlighted[t].element.getAttribute("data-x"),l=e.highlighted[t].element.getAttribute("data-y");"checkbox"!=e.options.columns[s].type&&"radio"!=e.options.columns[s].type||o.push(n.wW.call(e,s,l,!e.options.data[l][s]))}if(o.length){s.JB.call(e,{action:"setValue",records:o,selection:e.selectedCell});const n=o.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));t.Z.call(e,"onafterchanges",e,n)}};var i=__webpack_require__(665);const c=function(e,t){const n=this;e=parseInt(e);for(let s=(t=parseInt(t))-1;s>=0;s--)if("none"!=n.records[s][e].element.style.display&&"none"!=n.rows[s].element.style.display){if(n.records[s][e].element.getAttribute("data-merged")&&n.records[s][e].element==n.records[t][e].element)continue;t=s;break}return t},a=function(e,t){const n=this;let s,o;if(0==e?(s=parseInt(n.selectedCell[0]),o=parseInt(n.selectedCell[1])):(s=parseInt(n.selectedCell[2]),o=parseInt(n.selectedCell[3])),0==t){for(let e=0;e<o;e++)if("none"!=n.records[e][s].element.style.display&&"none"!=n.rows[e].element.style.display){o=e;break}}else o=c.call(n,s,o);0==e?(n.selectedCell[0]=s,n.selectedCell[1]=o):(n.selectedCell[2]=s,n.selectedCell[3]=o)},u=function(e,t){const s=this;if(e?s.selectedCell[3]>0&&a.call(s,1,t?0:1):(s.selectedCell[1]>0&&a.call(s,0,t?0:1),s.selectedCell[2]=s.selectedCell[0],s.selectedCell[3]=s.selectedCell[1]),s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]),1==s.options.lazyLoading)if(0==s.selectedCell[1]||0==s.selectedCell[3])i.ij.call(s,0),s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]);else if(i.iw.call(s))s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]);else{const e=parseInt(s.tbody.firstChild.getAttribute("data-y"));s.selectedCell[1]-e<30&&(i.Kw.call(s),s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]))}else if(s.options.pagination>0){const e=s.whichPage(s.selectedCell[3]);e!=s.pageNumber&&s.page(e)}n.Of.call(s,1)},d=function(e,t){const n=this;e=parseInt(e),t=parseInt(t);for(let s=e+1;s<n.headers.length;s++)if("none"!=n.records[t][s].element.style.display){if(n.records[t][s].element.getAttribute("data-merged")&&n.records[t][s].element==n.records[t][e].element)continue;e=s;break}return e},p=function(e,t){const n=this;let s,o;if(0==e?(s=parseInt(n.selectedCell[0]),o=parseInt(n.selectedCell[1])):(s=parseInt(n.selectedCell[2]),o=parseInt(n.selectedCell[3])),0==t){for(let e=n.headers.length-1;e>s;e--)if("none"!=n.records[o][e].element.style.display){s=e;break}}else s=d.call(n,s,o);0==e?(n.selectedCell[0]=s,n.selectedCell[1]=o):(n.selectedCell[2]=s,n.selectedCell[3]=o)},h=function(e,t){const s=this;e?s.selectedCell[2]<s.headers.length-1&&p.call(s,1,t?0:1):(s.selectedCell[0]<s.headers.length-1&&p.call(s,0,t?0:1),s.selectedCell[2]=s.selectedCell[0],s.selectedCell[3]=s.selectedCell[1]),s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]),n.Of.call(s,2)},m=function(e,t){const n=this;e=parseInt(e);for(let s=(t=parseInt(t))+1;s<n.rows.length;s++)if("none"!=n.records[s][e].element.style.display&&"none"!=n.rows[s].element.style.display){if(n.records[s][e].element.getAttribute("data-merged")&&n.records[s][e].element==n.records[t][e].element)continue;t=s;break}return t},f=function(e,t){const n=this;let s,o;if(0==e?(s=parseInt(n.selectedCell[0]),o=parseInt(n.selectedCell[1])):(s=parseInt(n.selectedCell[2]),o=parseInt(n.selectedCell[3])),0==t){for(let e=n.rows.length-1;e>o;e--)if("none"!=n.records[e][s].element.style.display&&"none"!=n.rows[e].element.style.display){o=e;break}}else o=m.call(n,s,o);0==e?(n.selectedCell[0]=s,n.selectedCell[1]=o):(n.selectedCell[2]=s,n.selectedCell[3]=o)},g=function(e,t){const s=this;if(e?s.selectedCell[3]<s.records.length-1&&f.call(s,1,t?0:1):(s.selectedCell[1]<s.records.length-1&&f.call(s,0,t?0:1),s.selectedCell[2]=s.selectedCell[0],s.selectedCell[3]=s.selectedCell[1]),s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]),1==s.options.lazyLoading)s.selectedCell[1]==s.records.length-1||s.selectedCell[3]==s.records.length-1?(i.ij.call(s,-1),s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3])):i.iw.call(s)?s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]):parseInt(s.tbody.lastChild.getAttribute("data-y"))-s.selectedCell[3]<30&&(i.VG.call(s),s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]));else if(s.options.pagination>0){const e=s.whichPage(s.selectedCell[3]);e!=s.pageNumber&&s.page(e)}n.Of.call(s,3)},C=function(e,t){const n=this;e=parseInt(e),t=parseInt(t);for(let s=e-1;s>=0;s--)if("none"!=n.records[t][s].element.style.display){if(n.records[t][s].element.getAttribute("data-merged")&&n.records[t][s].element==n.records[t][e].element)continue;e=s;break}return e},y=function(e,t){const n=this;let s,o;if(0==e?(s=parseInt(n.selectedCell[0]),o=parseInt(n.selectedCell[1])):(s=parseInt(n.selectedCell[2]),o=parseInt(n.selectedCell[3])),0==t){for(let e=0;e<s;e++)if("none"!=n.records[o][e].element.style.display){s=e;break}}else s=C.call(n,s,o);0==e?(n.selectedCell[0]=s,n.selectedCell[1]=o):(n.selectedCell[2]=s,n.selectedCell[3]=o)},j=function(e,t){const s=this;e?s.selectedCell[2]>0&&y.call(s,1,t?0:1):(s.selectedCell[0]>0&&y.call(s,0,t?0:1),s.selectedCell[2]=s.selectedCell[0],s.selectedCell[3]=s.selectedCell[1]),s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]),n.Of.call(s,0)},b=function(e,t){const s=this;if(e?t?s.selectedCell[3]=0:y.call(s,1,0):(t?s.selectedCell[1]=0:y.call(s,0,0),s.selectedCell[2]=s.selectedCell[0],s.selectedCell[3]=s.selectedCell[1]),1!=s.options.lazyLoading||0!=s.selectedCell[1]&&0!=s.selectedCell[3]){if(s.options.pagination>0){const e=s.whichPage(s.selectedCell[3]);e!=s.pageNumber&&s.page(e)}}else i.ij.call(s,0);s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]),n.Of.call(s,1)},w=function(e,t){const s=this;if(e?t?s.selectedCell[3]=s.records.length-1:p.call(s,1,0):(t?s.selectedCell[1]=s.records.length-1:p.call(s,0,0),s.selectedCell[2]=s.selectedCell[0],s.selectedCell[3]=s.selectedCell[1]),1!=s.options.lazyLoading||s.selectedCell[1]!=s.records.length-1&&s.selectedCell[3]!=s.records.length-1){if(s.options.pagination>0){const e=s.whichPage(s.selectedCell[3]);e!=s.pageNumber&&s.page(e)}}else i.ij.call(s,-1);s.updateSelectionFromCoords(s.selectedCell[0],s.selectedCell[1],s.selectedCell[2],s.selectedCell[3]),n.Of.call(s,3)};var _=__webpack_require__(49),A=__webpack_require__(366),E=__webpack_require__(650),v=__webpack_require__(323);const x=function(e,n,s,o,l,r,i){const c=this;n||(n="\t");const a=new RegExp(n,"ig"),u=[];let d=[],p=[];const h=[],m=[],f=c.options.data[0].length,g=c.options.data.length;let C="",y=!1,j="",b="",w=0,_=0,E=0,v=0,x=!0;for(let t=0;t<g;t++)for(let n=0;n<f;n++)e&&!c.records[t][n].element.classList.contains("highlight")||(E<=n&&(E=n),v<=t&&(v=t));if(f===E+1&&g===v+1&&!1,l&&(1==c.parent.config.includeHeadersOnDownload||o)){if(c.options.nestedHeaders&&c.options.nestedHeaders.length>0){C=c.options.nestedHeaders;for(let e=0;e<C.length;e++){const t=[];for(let n=0;n<C[e].length;n++){const s=parseInt(C[e][n].colspan);t.push(C[e][n].title);for(let e=0;e<s-1;e++)t.push("")}b+=t.join(n)+"\r\n"}}y=!0}c.style=[];for(let t=0;t<g;t++){d=[],p=[];for(let n=0;n<f;n++)if(!e||c.records[t][n].element.classList.contains("highlight")){1==y&&u.push(c.headers[n].textContent);let e,s=c.options.data[t][n];s.match&&(s.match(a)||s.match(/,/g)||s.match(/\n/)||s.match(/\"/))&&(s=s.replace(new RegExp('"',"g"),'""'),s='"'+s+'"'),d.push(s),c.options.columns&&c.options.columns[n]&&("checkbox"==c.options.columns[n].type||"radio"==c.options.columns[n].type)?e=s:(e=c.records[t][n].element.innerHTML,e.match&&(e.match(a)||e.match(/,/g)||e.match(/\n/)||e.match(/\"/))&&(e=e.replace(new RegExp('"',"g"),'""'),e='"'+e+'"')),p.push(e),C=c.records[t][n].element.getAttribute("style"),C=C.replace("display: none;",""),c.style.push(C||"")}d.length&&(y&&(w=d.length,h.push(u.join(n))),h.push(d.join(n))),p.length&&(_++,y&&(m.push(u.join(n)),y=!1),m.push(p.join(n)))}f==w&&g==_&&(j=b);const D=j+h.join("\r\n");let L=j+m.join("\r\n");if(!s){const e=[Math.min(c.selectedCell[0],c.selectedCell[2]),Math.min(c.selectedCell[1],c.selectedCell[3]),Math.max(c.selectedCell[0],c.selectedCell[2]),Math.max(c.selectedCell[1],c.selectedCell[3])],n=t.Z.call(c,"oncopy",c,e,L,r);if(n)L=n;else if(!1===n)return!1;c.textarea.value=L,c.textarea.select(),document.execCommand("copy")}if(c.data=1==i?L:D,c.hashString=A.vp.call(c,c.data),!s&&(A.vn.call(c),c.highlighted))for(let e=0;e<c.highlighted.length;e++)c.highlighted[e].element.classList.add("copying"),c.highlighted[e].element.classList.contains("highlight-left")&&c.highlighted[e].element.classList.add("copying-left"),c.highlighted[e].element.classList.contains("highlight-right")&&c.highlighted[e].element.classList.add("copying-right"),c.highlighted[e].element.classList.contains("highlight-top")&&c.highlighted[e].element.classList.add("copying-top"),c.highlighted[e].element.classList.contains("highlight-bottom")&&c.highlighted[e].element.classList.add("copying-bottom");return c.data},D=function(e,o,l){const r=this,i=(0,A.vp)(l),c=i==r.hashString?r.style:null;i==r.hashString&&(l=r.data),l=(0,E.parseCSV)(l,"\t");const a=t.Z.call(r,"onbeforepaste",r,l.map((function(e){return e.map((function(e){return{value:e}}))})),e,o);if(!1===a)return!1;if(a&&(l=a),null!=e&&null!=o&&l){let i=0,a=0;const u=[],p={},h={};let f=0,g=parseInt(e),C=parseInt(o),y=null;for(;y=l[a];){for(i=0,g=parseInt(e);null!=y[i];){const e=n.wW.call(r,g,C,y[i]);if(u.push(e),n.Zz.call(r,g,C,u),c&&c[f]){const e=(0,v.Ar)([g,C]);p[e]=c[f],h[e]=r.getStyle(e),r.records[C][g].element.setAttribute("style",c[f]),f++}if(i++,null!=y[i]){if(g>=r.headers.length-1){if(0==r.options.allowInsertColumn)break;r.insertColumn()}g=d.call(r,g,C)}}if(a++,l[a]){if(C>=r.rows.length-1){if(0==r.options.allowInsertRow)break;r.insertRow()}C=m.call(r,e,C)}}A.Es.call(r,e,o,g,C),s.JB.call(r,{action:"setValue",records:u,selection:r.selectedCell,newStyle:p,oldStyle:h}),n.T0.call(r);const j=[];for(let t=0;t<l.length;t++)for(let n=0;n<l[t].length;n++)j.push({x:n+e,y:t+o,value:l[t][n]});t.Z.call(r,"onpaste",r,j);const b=u.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));t.Z.call(r,"onafterchanges",r,b)}(0,A.vn)()};var L=__webpack_require__(456),I=__webpack_require__(427);const k=function(){const e=this;let t=e.options.columns&&e.options.columns.length||0;if(e.options.data&&void 0!==e.options.data[0]){const n=Object.keys(e.options.data[0]);n.length>t&&(t=n.length)}return e.options.minDimensions&&e.options.minDimensions[0]>t&&(t=e.options.minDimensions[0]),t},F=function(e){const t=this,n=t.options.columns&&t.options.columns[e]&&t.options.columns[e].width||t.options.defaultColWidth||100,s=t.options.columns&&t.options.columns[e]&&t.options.columns[e].align||t.options.defaultColAlign||"center";t.headers[e]=document.createElement("td"),t.headers[e].textContent=t.options.columns&&t.options.columns[e]&&t.options.columns[e].title||(0,E.getColumnName)(e),t.headers[e].setAttribute("data-x",e),t.headers[e].style.textAlign=s,t.options.columns&&t.options.columns[e]&&t.options.columns[e].title&&t.headers[e].setAttribute("title",t.headers[e].innerText),t.options.columns&&t.options.columns[e]&&t.options.columns[e].id&&t.headers[e].setAttribute("id",t.options.columns[e].id);const o=document.createElement("col");o.setAttribute("width",n),t.cols[e]={colElement:o,x:e},t.options.columns&&t.options.columns[e]&&"hidden"==t.options.columns[e].type&&(t.headers[e].style.display="none",o.style.display="none")},B=function(e,n,o){const l=this;if(n){if(Array.isArray(e)){o||(o=[]);for(let t=0;t<e.length;t++){o[t]||(o[t]=parseInt(l.cols[e[t]].colElement.getAttribute("width")));const s=Array.isArray(n)&&n[t]?n[t]:n;l.cols[e[t]].colElement.setAttribute("width",s),l.options.columns||(l.options.columns=[]),l.options.columns[e[t]]||(l.options.columns[e[t]]={}),l.options.columns[e[t]].width=s}}else o||(o=parseInt(l.cols[e].colElement.getAttribute("width"))),l.cols[e].colElement.setAttribute("width",n),l.options.columns||(l.options.columns=[]),l.options.columns[e]||(l.options.columns[e]={}),l.options.columns[e].width=n;s.JB.call(l,{action:"setWidth",column:e,oldValue:o,newValue:n}),t.Z.call(l,"onresizecolumn",l,e,n,o),A.x8.call(l)}},S=function(e,t){const s=this;s.records[e]||(s.records[e]=[]),t||(t=s.options.data[e]);const o={element:document.createElement("tr"),y:e};s.rows[e]=o,o.element.setAttribute("data-y",e);let l=null;s.options.defaultRowHeight&&(o.element.style.height=s.options.defaultRowHeight+"px"),s.options.rows&&s.options.rows[e]&&(s.options.rows[e].height&&(o.element.style.height=s.options.rows[e].height),s.options.rows[e].title&&(l=s.options.rows[e].title)),l||(l=parseInt(e+1));const r=document.createElement("td");r.innerHTML=l,r.setAttribute("data-y",e),r.className="jss_row",o.element.appendChild(r);const i=k.call(s);for(let l=0;l<i;l++)s.records[e][l]={element:n.kE.call(this,l,e,t[l]),x:l,y:e},o.element.appendChild(s.records[e][l].element),s.options.columns&&s.options.columns[l]&&"function"==typeof s.options.columns[l].render&&s.options.columns[l].render(s.records[e][l].element,t[l],parseInt(l),parseInt(e),s,s.options.columns[l]);return o},M=function(e,o,l){const r=this;if(r.options.mergeCells&&Object.keys(r.options.mergeCells).length>0){let t;if(t=e>o?1:0,_.q4.call(r,e).length||_.q4.call(r,o,t).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;r.destroyMerge()}}if(1==r.options.search){if(r.results&&r.results.length!=r.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;r.resetSearch()}r.results=null}l||(Array.prototype.indexOf.call(r.tbody.children,r.rows[o].element)>=0?e>o?r.tbody.insertBefore(r.rows[e].element,r.rows[o].element):r.tbody.insertBefore(r.rows[e].element,r.rows[o].element.nextSibling):r.tbody.removeChild(r.rows[e].element)),r.rows.splice(o,0,r.rows.splice(e,1)[0]),r.records.splice(o,0,r.records.splice(e,1)[0]),r.options.data.splice(o,0,r.options.data.splice(e,1)[0]);const i=Math.min(e,o),c=Math.max(e,o);for(let e=i;e<=c;e++)r.rows[e].y=e;for(let e=i;e<=c;e++)for(let t=0;t<r.records[e].length;t++)r.records[e][t].y=e;r.options.pagination>0&&r.tbody.children.length!=r.options.pagination&&r.page(r.pageNumber),s.JB.call(r,{action:"moveRow",oldValue:e,newValue:o}),n.ec.call(r),t.Z.call(r,"onmoverow",r,parseInt(e),parseInt(o),1)},O=function(e,n,o){const l=this;n>0&&(o||(o=l.rows[e].element.getAttribute("height"))||(o=l.rows[e].element.getBoundingClientRect().height),n=parseInt(n),l.rows[e].element.style.height=n+"px",l.options.rows||(l.options.rows=[]),l.options.rows[e]||(l.options.rows[e]={}),l.options.rows[e].height=n,s.JB.call(l,{action:"setHeight",row:e,oldValue:o,newValue:n}),t.Z.call(l,"onresizerow",l,e,n,o),A.x8.call(l))};var T={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license].join("\r\n")]}};const H=function(e){let t=0,n=0;return function e(s){s.className&&(s.classList.contains("jss_container")&&(n=s),s.classList.contains("jss_spreadsheet")&&(n=s.querySelector(":scope > .jtabs-content > .jtabs-selected"))),"THEAD"==s.tagName?t=1:"TBODY"==s.tagName&&(t=2),s.parentNode&&(n||e(s.parentNode))}(e),[n,t]},N=function(t){if(e.jspreadsheet.current)if(e.jspreadsheet.current.resizing){if(e.jspreadsheet.current.resizing.column){const t=parseInt(e.jspreadsheet.current.cols[e.jspreadsheet.current.resizing.column].colElement.getAttribute("width")),n=e.jspreadsheet.current.getSelectedColumns();if(n.length>1){const s=[];for(let t=0;t<n.length;t++)s.push(parseInt(e.jspreadsheet.current.cols[n[t]].colElement.getAttribute("width")));s[n.indexOf(parseInt(e.jspreadsheet.current.resizing.column))]=e.jspreadsheet.current.resizing.width,B.call(e.jspreadsheet.current,n,t,s)}else B.call(e.jspreadsheet.current,parseInt(e.jspreadsheet.current.resizing.column),t,e.jspreadsheet.current.resizing.width);e.jspreadsheet.current.headers[e.jspreadsheet.current.resizing.column].classList.remove("resizing");for(let t=0;t<e.jspreadsheet.current.records.length;t++)e.jspreadsheet.current.records[t][e.jspreadsheet.current.resizing.column]&&e.jspreadsheet.current.records[t][e.jspreadsheet.current.resizing.column].element.classList.remove("resizing")}else{e.jspreadsheet.current.rows[e.jspreadsheet.current.resizing.row].element.children[0].classList.remove("resizing");let t=e.jspreadsheet.current.rows[e.jspreadsheet.current.resizing.row].element.getAttribute("height");O.call(e.jspreadsheet.current,e.jspreadsheet.current.resizing.row,t,e.jspreadsheet.current.resizing.height),e.jspreadsheet.current.resizing.element.classList.remove("resizing")}e.jspreadsheet.current.resizing=null}else if(e.jspreadsheet.current.dragging){if(e.jspreadsheet.current.dragging){if(e.jspreadsheet.current.dragging.column){const n=t.target.getAttribute("data-x");e.jspreadsheet.current.headers[e.jspreadsheet.current.dragging.column].classList.remove("dragging");for(let t=0;t<e.jspreadsheet.current.rows.length;t++)e.jspreadsheet.current.records[t][e.jspreadsheet.current.dragging.column]&&e.jspreadsheet.current.records[t][e.jspreadsheet.current.dragging.column].element.classList.remove("dragging");for(let t=0;t<e.jspreadsheet.current.headers.length;t++)e.jspreadsheet.current.headers[t].classList.remove("dragging-left"),e.jspreadsheet.current.headers[t].classList.remove("dragging-right");n&&e.jspreadsheet.current.dragging.column!=e.jspreadsheet.current.dragging.destination&&e.jspreadsheet.current.moveColumn(e.jspreadsheet.current.dragging.column,e.jspreadsheet.current.dragging.destination)}else{let t;e.jspreadsheet.current.dragging.element.nextSibling?(t=parseInt(e.jspreadsheet.current.dragging.element.nextSibling.getAttribute("data-y")),e.jspreadsheet.current.dragging.row<t&&(t-=1)):t=parseInt(e.jspreadsheet.current.dragging.element.previousSibling.getAttribute("data-y")),e.jspreadsheet.current.dragging.row!=e.jspreadsheet.current.dragging.destination&&M.call(e.jspreadsheet.current,e.jspreadsheet.current.dragging.row,t,!0),e.jspreadsheet.current.dragging.element.classList.remove("dragging")}e.jspreadsheet.current.dragging=null}}else e.jspreadsheet.current.selectedCorner&&(e.jspreadsheet.current.selectedCorner=!1,e.jspreadsheet.current.selection.length>0&&(A.F1.call(e.jspreadsheet.current,e.jspreadsheet.current.selection[0],e.jspreadsheet.current.selection[e.jspreadsheet.current.selection.length-1]),A.Mt.call(e.jspreadsheet.current)));e.jspreadsheet.timeControl&&(clearTimeout(e.jspreadsheet.timeControl),e.jspreadsheet.timeControl=null),e.jspreadsheet.isMouseAction=!1},R=function(t){let n;n=(t=t||window.event).buttons?t.buttons:t.button?t.button:t.which;const s=H(t.target);if(s[0]?e.jspreadsheet.current!=s[0].jssWorksheet&&(e.jspreadsheet.current&&(e.jspreadsheet.current.edition&&l.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0),e.jspreadsheet.current.resetSelection()),e.jspreadsheet.current=s[0].jssWorksheet):e.jspreadsheet.current&&(e.jspreadsheet.current.edition&&l.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0),t.target.classList.contains("jss_object")||(A.yE.call(e.jspreadsheet.current,!0),e.jspreadsheet.current=null)),e.jspreadsheet.current&&1==n){if(t.target.classList.contains("jss_selectall"))e.jspreadsheet.current&&A.td.call(e.jspreadsheet.current);else if(t.target.classList.contains("jss_corner"))0!=e.jspreadsheet.current.options.editable&&(e.jspreadsheet.current.selectedCorner=!0);else{if(1==s[1]){const n=t.target.getAttribute("data-x");if(n){const s=t.target.getBoundingClientRect();if(0!=e.jspreadsheet.current.options.columnResize&&s.width-t.offsetX<6){e.jspreadsheet.current.resizing={mousePosition:t.pageX,column:n,width:s.width},e.jspreadsheet.current.headers[n].classList.add("resizing");for(let t=0;t<e.jspreadsheet.current.records.length;t++)e.jspreadsheet.current.records[t][n]&&e.jspreadsheet.current.records[t][n].element.classList.add("resizing")}else if(0!=e.jspreadsheet.current.options.columnDrag&&s.height-t.offsetY<6)if(_.D0.call(e.jspreadsheet.current,n).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{e.jspreadsheet.current.resetSelection(),e.jspreadsheet.current.dragging={element:t.target,column:n,destination:n},e.jspreadsheet.current.headers[n].classList.add("dragging");for(let t=0;t<e.jspreadsheet.current.records.length;t++)e.jspreadsheet.current.records[t][n]&&e.jspreadsheet.current.records[t][n].element.classList.add("dragging")}else{let s,o;e.jspreadsheet.current.selectedHeader&&(t.shiftKey||t.ctrlKey)?(s=e.jspreadsheet.current.selectedHeader,o=n):(e.jspreadsheet.current.selectedHeader==n&&0!=e.jspreadsheet.current.options.allowRenameColumn&&(e.jspreadsheet.timeControl=setTimeout((function(){e.jspreadsheet.current.setHeader(n)}),800)),e.jspreadsheet.current.selectedHeader=n,s=n,o=n),A.Es.call(e.jspreadsheet.current,s,0,o,e.jspreadsheet.current.options.data.length-1,t)}}else if(t.target.parentNode.classList.contains("jss_nested")){let n,s;if(t.target.getAttribute("data-column")){const e=t.target.getAttribute("data-column").split(",");n=parseInt(e[0]),s=parseInt(e[e.length-1])}else n=0,s=e.jspreadsheet.current.options.columns.length-1;A.Es.call(e.jspreadsheet.current,n,0,s,e.jspreadsheet.current.options.data.length-1,t)}}else e.jspreadsheet.current.selectedHeader=!1;if(2==s[1]){const n=parseInt(t.target.getAttribute("data-y"));if(t.target.classList.contains("jss_row")){const s=t.target.getBoundingClientRect();if(0!=e.jspreadsheet.current.options.rowResize&&s.height-t.offsetY<6)e.jspreadsheet.current.resizing={element:t.target.parentNode,mousePosition:t.pageY,row:n,height:s.height},t.target.parentNode.classList.add("resizing");else if(0!=e.jspreadsheet.current.options.rowDrag&&s.width-t.offsetX<6)_.q4.call(e.jspreadsheet.current,n).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==e.jspreadsheet.current.options.search&&e.jspreadsheet.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(e.jspreadsheet.current.resetSelection(),e.jspreadsheet.current.dragging={element:t.target.parentNode,row:n,destination:n},t.target.parentNode.classList.add("dragging"));else{let s,o;e.jspreadsheet.current.selectedRow&&(t.shiftKey||t.ctrlKey)?(s=e.jspreadsheet.current.selectedRow,o=n):(e.jspreadsheet.current.selectedRow=n,s=n,o=n),A.Es.call(e.jspreadsheet.current,null,s,null,o,t)}}else if(t.target.classList.contains("jclose")&&t.target.clientWidth-t.offsetX<50&&t.offsetY<50)l.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0);else{const n=function(e){const t=e.getAttribute("data-x"),s=e.getAttribute("data-y");return t&&s?[t,s]:e.parentNode?n(e.parentNode):void 0},s=n(t.target);if(s){const n=s[0],o=s[1];e.jspreadsheet.current.edition&&(e.jspreadsheet.current.edition[2]==n&&e.jspreadsheet.current.edition[3]==o||l.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0)),e.jspreadsheet.current.edition||(t.shiftKey?A.Es.call(e.jspreadsheet.current,e.jspreadsheet.current.selectedCell[0],e.jspreadsheet.current.selectedCell[1],n,o,t):A.Es.call(e.jspreadsheet.current,n,o,void 0,void 0,t)),e.jspreadsheet.current.selectedHeader=null,e.jspreadsheet.current.selectedRow=null}}}else e.jspreadsheet.current.selectedRow=!1;t.target.classList.contains("jss_page")&&("<"==t.target.textContent?e.jspreadsheet.current.page(0):">"==t.target.textContent?e.jspreadsheet.current.page(t.target.getAttribute("title")-1):e.jspreadsheet.current.page(t.target.textContent-1))}e.jspreadsheet.current.edition?e.jspreadsheet.isMouseAction=!1:e.jspreadsheet.isMouseAction=!0}else e.jspreadsheet.isMouseAction=!1},P=function(t){let n;if(n=(t=t||window.event).buttons?t.buttons:t.button?t.button:t.which,n||(e.jspreadsheet.isMouseAction=!1),e.jspreadsheet.current)if(1==e.jspreadsheet.isMouseAction){if(e.jspreadsheet.current.resizing)if(e.jspreadsheet.current.resizing.column){const n=t.pageX-e.jspreadsheet.current.resizing.mousePosition;if(e.jspreadsheet.current.resizing.width+n>0){const t=e.jspreadsheet.current.resizing.width+n;e.jspreadsheet.current.cols[e.jspreadsheet.current.resizing.column].colElement.setAttribute("width",t),A.x8.call(e.jspreadsheet.current)}}else{const n=t.pageY-e.jspreadsheet.current.resizing.mousePosition;if(e.jspreadsheet.current.resizing.height+n>0){const t=e.jspreadsheet.current.resizing.height+n;e.jspreadsheet.current.rows[e.jspreadsheet.current.resizing.row].element.setAttribute("height",t),A.x8.call(e.jspreadsheet.current)}}else if(e.jspreadsheet.current.dragging)if(e.jspreadsheet.current.dragging.column){const n=t.target.getAttribute("data-x");if(n)if(_.D0.call(e.jspreadsheet.current,n).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(let t=0;t<e.jspreadsheet.current.headers.length;t++)e.jspreadsheet.current.headers[t].classList.remove("dragging-left"),e.jspreadsheet.current.headers[t].classList.remove("dragging-right");e.jspreadsheet.current.dragging.column==n?e.jspreadsheet.current.dragging.destination=parseInt(n):t.target.clientWidth/2>t.offsetX?(e.jspreadsheet.current.dragging.column<n?e.jspreadsheet.current.dragging.destination=parseInt(n)-1:e.jspreadsheet.current.dragging.destination=parseInt(n),e.jspreadsheet.current.headers[n].classList.add("dragging-left")):(e.jspreadsheet.current.dragging.column<n?e.jspreadsheet.current.dragging.destination=parseInt(n):e.jspreadsheet.current.dragging.destination=parseInt(n)+1,e.jspreadsheet.current.headers[n].classList.add("dragging-right"))}}else{const n=t.target.getAttribute("data-y");if(n)if(_.q4.call(e.jspreadsheet.current,n).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{const n=t.target.clientHeight/2>t.offsetY?t.target.parentNode.nextSibling:t.target.parentNode;e.jspreadsheet.current.dragging.element!=n&&(t.target.parentNode.parentNode.insertBefore(e.jspreadsheet.current.dragging.element,n),e.jspreadsheet.current.dragging.destination=Array.prototype.indexOf.call(e.jspreadsheet.current.dragging.element.parentNode.children,e.jspreadsheet.current.dragging.element))}}}else{const n=t.target.getAttribute("data-x"),s=t.target.getAttribute("data-y"),o=t.target.getBoundingClientRect();e.jspreadsheet.current.cursor&&(e.jspreadsheet.current.cursor.style.cursor="",e.jspreadsheet.current.cursor=null),t.target.parentNode.parentNode&&t.target.parentNode.parentNode.className&&(t.target.parentNode.parentNode.classList.contains("resizable")&&(t.target&&n&&!s&&o.width-(t.clientX-o.left)<6?(e.jspreadsheet.current.cursor=t.target,e.jspreadsheet.current.cursor.style.cursor="col-resize"):t.target&&!n&&s&&o.height-(t.clientY-o.top)<6&&(e.jspreadsheet.current.cursor=t.target,e.jspreadsheet.current.cursor.style.cursor="row-resize")),t.target.parentNode.parentNode.classList.contains("draggable")&&(t.target&&!n&&s&&o.width-(t.clientX-o.left)<6||t.target&&n&&!s&&o.height-(t.clientY-o.top)<6)&&(e.jspreadsheet.current.cursor=t.target,e.jspreadsheet.current.cursor.style.cursor="move"))}},W=function(e,t){const n=this;A.Mt.call(n);const s=n.selectedContainer[0],o=n.selectedContainer[1],l=n.selectedContainer[2],r=n.selectedContainer[3];if(null!=e&&null!=t){let i,c,a,u;e-l>0?(i=parseInt(l)+1,c=parseInt(e)):(i=parseInt(e),c=parseInt(s)-1),t-r>0?(a=parseInt(r)+1,u=parseInt(t)):(a=parseInt(t),u=parseInt(o)-1),c-i<=u-a?(i=parseInt(s),c=parseInt(l)):(a=parseInt(o),u=parseInt(r));for(let e=a;e<=u;e++)for(let t=i;t<=c;t++)n.records[e][t]&&"none"!=n.rows[e].element.style.display&&"none"!=n.records[e][t].element.style.display&&(n.records[e][t].element.classList.add("selection"),n.records[a][t].element.classList.add("selection-top"),n.records[u][t].element.classList.add("selection-bottom"),n.records[e][i].element.classList.add("selection-left"),n.records[e][c].element.classList.add("selection-right"),n.selection.push(n.records[e][t].element))}},V=function(t){let n;if(n=(t=t||window.event).buttons?t.buttons:t.button?t.button:t.which,n||(e.jspreadsheet.isMouseAction=!1),e.jspreadsheet.current&&1==e.jspreadsheet.isMouseAction){const n=H(t.target);if(n[0]){if(e.jspreadsheet.current!=n[0].jssWorksheet&&e.jspreadsheet.current)return!1;let s=t.target.getAttribute("data-x");const o=t.target.getAttribute("data-y");if(e.jspreadsheet.current.resizing||e.jspreadsheet.current.dragging);else{if(1==n[1]&&e.jspreadsheet.current.selectedHeader){s=t.target.getAttribute("data-x");const n=e.jspreadsheet.current.selectedHeader,o=s;A.Es.call(e.jspreadsheet.current,n,0,o,e.jspreadsheet.current.options.data.length-1,t)}if(2==n[1])if(t.target.classList.contains("jss_row")){if(e.jspreadsheet.current.selectedRow){const n=e.jspreadsheet.current.selectedRow,s=o;A.Es.call(e.jspreadsheet.current,0,n,e.jspreadsheet.current.options.data[0].length-1,s,t)}}else e.jspreadsheet.current.edition||s&&o&&(e.jspreadsheet.current.selectedCorner?W.call(e.jspreadsheet.current,s,o):e.jspreadsheet.current.selectedCell&&A.Es.call(e.jspreadsheet.current,e.jspreadsheet.current.selectedCell[0],e.jspreadsheet.current.selectedCell[1],s,o,t))}}}e.jspreadsheet.timeControl&&(clearTimeout(e.jspreadsheet.timeControl),e.jspreadsheet.timeControl=null)},z=function(t){if(e.jspreadsheet.current)if(t.target.classList.contains("jss_corner")){if(e.jspreadsheet.current.highlighted.length>0){const t=e.jspreadsheet.current.highlighted[0].element.getAttribute("data-x"),n=parseInt(e.jspreadsheet.current.highlighted[e.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-y"))+1,s=e.jspreadsheet.current.highlighted[e.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-x"),o=e.jspreadsheet.current.records.length-1;A.F1.call(e.jspreadsheet.current,e.jspreadsheet.current.records[n][t].element,e.jspreadsheet.current.records[o][s].element)}}else if(t.target.classList.contains("jss_column_filter")){const n=t.target.getAttribute("data-x");L.B4.call(e.jspreadsheet.current,n)}else{const n=H(t.target);if(1==n[1]&&0!=e.jspreadsheet.current.options.columnSorting){const n=t.target.getAttribute("data-x");n&&e.jspreadsheet.current.orderBy(parseInt(n))}if(2==n[1]&&0!=e.jspreadsheet.current.options.editable&&!e.jspreadsheet.current.edition){const n=function(e){if(e.parentNode){const t=e.getAttribute("data-x"),s=e.getAttribute("data-y");return t&&s?e:n(e.parentNode)}},s=n(t.target);s&&s.classList.contains("highlight")&&o.call(e.jspreadsheet.current,s,void 0,t)}}},q=function(t){e.jspreadsheet.current&&e.jspreadsheet.current.selectedCell&&(e.jspreadsheet.current.edition||0!=e.jspreadsheet.current.options.editable&&(t&&t.clipboardData?(D.call(e.jspreadsheet.current,e.jspreadsheet.current.selectedCell[0],e.jspreadsheet.current.selectedCell[1],t.clipboardData.getData("text")),t.preventDefault()):window.clipboardData&&D.call(e.jspreadsheet.current,e.jspreadsheet.current.selectedCell[0],e.jspreadsheet.current.selectedCell[1],window.clipboardData.getData("text"))))},Z=function(e){const t=e.parentElement.children;for(let n=0;n<t.length;n++)if(e===t[n])return n;return-1},K=function(t){if("buttons"in(t=t||window.event)?t.buttons:t.which||t.button,e.jspreadsheet.current){const n=e.jspreadsheet.current.parent;if(e.jspreadsheet.current.edition)t.preventDefault();else if(n.contextMenu.contextmenu.close(),e.jspreadsheet.current){const s=function(e){if(e.classList.contains("jss_selectall"))return"select-all";if(e.classList.contains("jss_corner"))return"fill-handle";let t=e;for(;!t.classList.contains("jss_spreadsheet");){if(t.classList.contains("jss_row"))return"row";if(t.classList.contains("jss_nested"))return"nested";if(t.classList.contains("jtabs-headers"))return"tabs";if(t.classList.contains("jtoolbar"))return"toolbar";if(t.classList.contains("jss_pagination"))return"pagination";if("TBODY"===t.tagName)return"cell";if("TFOOT"===t.tagName)return 0===Z(e)?"grid":"footer";if("THEAD"===t.tagName)return"header";t=t.parentElement}return"applications"}(t.target);let o=null,l=null;if("cell"===s||"row"===s||"header"===s)"cell"!==s&&"row"!==s||(l=t.target.getAttribute("data-y")),"cell"!==s&&"header"!==s||(o=t.target.getAttribute("data-x")),(!e.jspreadsheet.current.selectedCell||o<parseInt(e.jspreadsheet.current.selectedCell[0])||o>parseInt(e.jspreadsheet.current.selectedCell[2])||l<parseInt(e.jspreadsheet.current.selectedCell[1])||l>parseInt(e.jspreadsheet.current.selectedCell[3]))&&A.Es.call(e.jspreadsheet.current,o,l,o,l,t);else if("nested"===s){const n=t.target.getAttribute("data-column").split(",");o=Z(t.target)-1,l=Z(t.target.parentElement),e.jspreadsheet.current.selectedCell&&n[0]==parseInt(e.jspreadsheet.current.selectedCell[0])&&n[n.length-1]==parseInt(e.jspreadsheet.current.selectedCell[2])&&null==e.jspreadsheet.current.selectedCell[1]&&null==e.jspreadsheet.current.selectedCell[3]||A.Es.call(e.jspreadsheet.current,n[0],null,n[n.length-1],null,t)}else"select-all"===s?A.td.call(e.jspreadsheet.current):"tabs"===s?o=Z(t.target):"footer"===s&&(o=Z(t.target)-1,l=Z(t.target.parentElement));let r=function(e,t,n,s){const o=[];if("header"===s&&(0!=e.options.allowInsertColumn&&o.push({title:jSuites.translate("Insert a new column before"),onclick:function(){e.insertColumn(1,parseInt(t),1)}}),0!=e.options.allowInsertColumn&&o.push({title:jSuites.translate("Insert a new column after"),onclick:function(){e.insertColumn(1,parseInt(t),0)}}),0!=e.options.allowDeleteColumn&&o.push({title:jSuites.translate("Delete selected columns"),onclick:function(){e.deleteColumn(e.getSelectedColumns().length?void 0:parseInt(t))}}),0!=e.options.allowRenameColumn&&o.push({title:jSuites.translate("Rename this column"),onclick:function(){const n=e.getHeader(t),s=prompt(jSuites.translate("Column name"),n);e.setHeader(t,s)}}),0!=e.options.columnSorting&&(o.push({type:"line"}),o.push({title:jSuites.translate("Order ascending"),onclick:function(){e.orderBy(t,0)}}),o.push({title:jSuites.translate("Order descending"),onclick:function(){e.orderBy(t,1)}}))),"row"!==s&&"cell"!==s||(0!=e.options.allowInsertRow&&(o.push({title:jSuites.translate("Insert a new row before"),onclick:function(){e.insertRow(1,parseInt(n),1)}}),o.push({title:jSuites.translate("Insert a new row after"),onclick:function(){e.insertRow(1,parseInt(n))}})),0!=e.options.allowDeleteRow&&o.push({title:jSuites.translate("Delete selected rows"),onclick:function(){e.deleteRow(e.getSelectedRows().length?void 0:parseInt(n))}})),"cell"===s&&0!=e.options.allowComments){o.push({type:"line"});const s=e.records[n][t].element.getAttribute("title")||"";o.push({title:jSuites.translate(s?"Edit comments":"Add comments"),onclick:function(){const o=prompt(jSuites.translate("Comments"),s);o&&e.setComments((0,E.getCellNameFromCoords)(t,n),o)}}),s&&o.push({title:jSuites.translate("Clear comments"),onclick:function(){e.setComments((0,E.getCellNameFromCoords)(t,n),"")}})}return 0!==o.length&&o.push({type:"line"}),"header"!==s&&"row"!==s&&"cell"!==s||(o.push({title:jSuites.translate("Copy..."),shortcut:"Ctrl + C",onclick:function(){x.call(e,!0)}}),navigator&&navigator.clipboard&&o.push({title:jSuites.translate("Paste..."),shortcut:"Ctrl + V",onclick:function(){e.selectedCell&&navigator.clipboard.readText().then((function(t){t&&D.call(e,e.selectedCell[0],e.selectedCell[1],t)}))}})),0!=e.parent.config.allowExport&&o.push({title:jSuites.translate("Save as..."),shortcut:"Ctrl + S",onclick:function(){e.download()}}),0!=e.parent.config.about&&o.push({title:jSuites.translate("About"),onclick:function(){void 0===e.parent.config.about||!0===e.parent.config.about?alert(T.print()):alert(e.parent.config.about)}}),o}(e.jspreadsheet.current,parseInt(o),parseInt(l),s);if("function"==typeof n.config.contextMenu){const i=n.config.contextMenu(e.jspreadsheet.current,o,l,t,r,s,o,l);if(i)r=i;else if(!1===i)return}"object"==typeof n.plugins&&Object.entries(n.plugins).forEach((function([,n]){if("function"==typeof n.contextMenu){const i=n.contextMenu(e.jspreadsheet.current,null!==o?parseInt(o):null,null!==l?parseInt(l):null,t,r,s,null!==o?parseInt(o):null,null!==l?parseInt(l):null);i&&(r=i)}})),n.contextMenu.contextmenu.open(t,r),t.preventDefault()}}},U=function(t){const n=H(t.target);if(n[0]?e.jspreadsheet.current!=n[0].jssWorksheet&&(e.jspreadsheet.current&&e.jspreadsheet.current.resetSelection(),e.jspreadsheet.current=n[0].jssWorksheet):e.jspreadsheet.current&&(e.jspreadsheet.current.resetSelection(),e.jspreadsheet.current=null),e.jspreadsheet.current&&!e.jspreadsheet.current.edition){const n=t.target.getAttribute("data-x"),s=t.target.getAttribute("data-y");n&&s&&(A.Es.call(e.jspreadsheet.current,n,s,void 0,void 0,t),e.jspreadsheet.timeControl=setTimeout((function(){"color"==e.jspreadsheet.current.options.columns[n].type?e.jspreadsheet.tmpElement=null:e.jspreadsheet.tmpElement=t.target,o.call(e.jspreadsheet.current,t.target,!1,t)}),500))}},J=function(t){e.jspreadsheet.timeControl&&(clearTimeout(e.jspreadsheet.timeControl),e.jspreadsheet.timeControl=null,e.jspreadsheet.tmpElement&&"INPUT"==e.jspreadsheet.tmpElement.children[0].tagName&&e.jspreadsheet.tmpElement.children[0].focus(),e.jspreadsheet.tmpElement=null)},Y=function(t){e.jspreadsheet.current&&(e.jspreadsheet.current.edition||(x.call(e.jspreadsheet.current,!0,void 0,void 0,void 0,void 0,!0),0!=e.jspreadsheet.current.options.editable&&e.jspreadsheet.current.setValue(e.jspreadsheet.current.highlighted.map((function(e){return e.element})),"")))},X=function(t){e.jspreadsheet.current&&X.enabled&&(e.jspreadsheet.current.edition||x.call(e.jspreadsheet.current,!0))},G=function(t){if(e.jspreadsheet.current){if(e.jspreadsheet.current.edition)if(27==t.which)e.jspreadsheet.current.edition&&l.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!1),t.preventDefault();else if(13==t.which)if(e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]]&&"calendar"==e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]].type)l.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0);else if(e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]]&&"dropdown"==e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]].type);else if((1==e.jspreadsheet.current.options.wordWrap||e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]]&&1==e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]].wordWrap||e.jspreadsheet.current.options.data[e.jspreadsheet.current.edition[3]][e.jspreadsheet.current.edition[2]]&&e.jspreadsheet.current.options.data[e.jspreadsheet.current.edition[3]][e.jspreadsheet.current.edition[2]].length>200)&&t.altKey){const t=e.jspreadsheet.current.edition[0].children[0];let n=e.jspreadsheet.current.edition[0].children[0].value;const s=t.selectionStart;n=n.slice(0,s)+"\n"+n.slice(s),t.value=n,t.focus(),t.selectionStart=s+1,t.selectionEnd=s+1}else e.jspreadsheet.current.edition[0].children[0].blur();else 9==t.which&&(e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]]&&["calendar","html"].includes(e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]].type)?l.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0):e.jspreadsheet.current.edition[0].children[0].blur());if(!e.jspreadsheet.current.edition&&e.jspreadsheet.current.selectedCell)if(37==t.which)j.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(39==t.which)h.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(38==t.which)u.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(40==t.which)g.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(36==t.which)b.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(35==t.which)w.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(46==t.which)0!=e.jspreadsheet.current.options.editable&&(e.jspreadsheet.current.selectedRow?0!=e.jspreadsheet.current.options.allowDeleteRow&&confirm(jSuites.translate("Are you sure to delete the selected rows?"))&&e.jspreadsheet.current.deleteRow():e.jspreadsheet.current.selectedHeader?0!=e.jspreadsheet.current.options.allowDeleteColumn&&confirm(jSuites.translate("Are you sure to delete the selected columns?"))&&e.jspreadsheet.current.deleteColumn():e.jspreadsheet.current.setValue(e.jspreadsheet.current.highlighted.map((function(e){return e.element})),""));else if(13==t.which)t.shiftKey?u.call(e.jspreadsheet.current):(0!=e.jspreadsheet.current.options.allowInsertRow&&0!=e.jspreadsheet.current.options.allowManualInsertRow&&e.jspreadsheet.current.selectedCell[1]==e.jspreadsheet.current.options.data.length-1&&e.jspreadsheet.current.insertRow(),g.call(e.jspreadsheet.current)),t.preventDefault();else if(9==t.which)t.shiftKey?j.call(e.jspreadsheet.current):(0!=e.jspreadsheet.current.options.allowInsertColumn&&0!=e.jspreadsheet.current.options.allowManualInsertColumn&&e.jspreadsheet.current.selectedCell[0]==e.jspreadsheet.current.options.data[0].length-1&&e.jspreadsheet.current.insertColumn(),h.call(e.jspreadsheet.current)),t.preventDefault();else if(!t.ctrlKey&&!t.metaKey||t.shiftKey){if(e.jspreadsheet.current.selectedCell&&0!=e.jspreadsheet.current.options.editable){const n=e.jspreadsheet.current.selectedCell[1],s=e.jspreadsheet.current.selectedCell[0];32==t.keyCode?(t.preventDefault(),"checkbox"==e.jspreadsheet.current.options.columns[s].type||"radio"==e.jspreadsheet.current.options.columns[s].type?r.call(e.jspreadsheet.current):o.call(e.jspreadsheet.current,e.jspreadsheet.current.records[n][s].element,!0,t)):113==t.keyCode?o.call(e.jspreadsheet.current,e.jspreadsheet.current.records[n][s].element,!1,t):(8==t.keyCode||t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=111||t.keyCode>=187&&t.keyCode<=190||(String.fromCharCode(t.keyCode)==t.key||String.fromCharCode(t.keyCode).toLowerCase()==t.key.toLowerCase())&&String.fromCharCode(t.keyCode).match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g))&&(o.call(e.jspreadsheet.current,e.jspreadsheet.current.records[n][s].element,!0,t),e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[s]&&"calendar"==e.jspreadsheet.current.options.columns[s].type&&t.preventDefault())}}else 65==t.which?(A.td.call(e.jspreadsheet.current),t.preventDefault()):83==t.which?(e.jspreadsheet.current.download(),t.preventDefault()):89==t.which?(e.jspreadsheet.current.redo(),t.preventDefault()):90==t.which?(e.jspreadsheet.current.undo(),t.preventDefault()):67==t.which?(x.call(e.jspreadsheet.current,!0),t.preventDefault()):88==t.which?(0!=e.jspreadsheet.current.options.editable?Y():X(),t.preventDefault()):86==t.which&&q();else t.target.classList.contains("jss_search")&&(e.jspreadsheet.timeControl&&clearTimeout(e.jspreadsheet.timeControl),e.jspreadsheet.timeControl=setTimeout((function(){e.jspreadsheet.current.search(t.target.value)}),200))}},Q=function(t){const n=this;1==n.options.lazyLoading&&null==e.jspreadsheet.timeControlLoading&&(e.jspreadsheet.timeControlLoading=setTimeout((function(){n.content.scrollTop+n.content.clientHeight>=n.content.scrollHeight-10?i.VG.call(n)&&(n.content.scrollTop+n.content.clientHeight>n.content.scrollHeight-10&&(n.content.scrollTop=n.content.scrollTop-n.content.clientHeight),A.x8.call(n)):n.content.scrollTop<=n.content.clientHeight&&i.Kw.call(n)&&(n.content.scrollTop<10&&(n.content.scrollTop=n.content.scrollTop+n.content.clientHeight),A.x8.call(n)),e.jspreadsheet.timeControlLoading=null}),100))};let ee=0;const te=function(){const e=this;ee=e.content.scrollLeft;let t=0;if(ee>50)for(let n=0;n<e.options.freezeColumns;n++){if(n>0&&(!e.options.columns||!e.options.columns[n-1]||"hidden"!==e.options.columns[n-1].type)){let s;s=e.options.columns&&e.options.columns[n-1]&&void 0!==e.options.columns[n-1].width?parseInt(e.options.columns[n-1].width):void 0!==e.options.defaultColWidth?parseInt(e.options.defaultColWidth):100,t+=parseInt(s)}e.headers[n].classList.add("jss_freezed"),e.headers[n].style.left=t+"px";for(let t=0;t<e.rows.length;t++)if(e.rows[t]&&e.records[t][n]){const s=ee+(n>0?e.records[t][n-1].element.style.width:0)-51+"px";e.records[t][n].element.classList.add("jss_freezed"),e.records[t][n].element.style.left=s}}else for(let t=0;t<e.options.freezeColumns;t++){e.headers[t].classList.remove("jss_freezed"),e.headers[t].style.left="";for(let n=0;n<e.rows.length;n++)e.records[n][t]&&(e.records[n][t].element.classList.remove("jss_freezed"),e.records[n][t].element.style.left="")}A.x8.call(e)},ne=function(e){const t=this;Q.call(t),t.options.freezeColumns>0&&t.content.scrollLeft!=ee&&te.call(t),1!=t.options.lazyLoading&&1!=t.options.tableOverflow||t.edition&&"jdropdown"!=e.target.className.substr(0,9)&&l.call(t,t.edition[0],!0)},se=function(e){oe(e),e.addEventListener("mouseup",N),e.addEventListener("mousedown",R),e.addEventListener("mousemove",P),e.addEventListener("mouseover",V),e.addEventListener("dblclick",z),e.addEventListener("paste",q),e.addEventListener("contextmenu",K),e.addEventListener("touchstart",U),e.addEventListener("touchend",J),e.addEventListener("touchcancel",J),e.addEventListener("touchmove",J),document.addEventListener("keydown",G)},oe=function(e){e.removeEventListener("mouseup",N),e.removeEventListener("mousedown",R),e.removeEventListener("mousemove",P),e.removeEventListener("mouseover",V),e.removeEventListener("dblclick",z),e.removeEventListener("paste",q),e.removeEventListener("contextmenu",K),e.removeEventListener("touchstart",U),e.removeEventListener("touchend",J),e.removeEventListener("touchcancel",J),document.removeEventListener("keydown",G)};var le=__webpack_require__(898),re=__webpack_require__(673);const ie=function(e,n,o,l,r){const i=this,c={},a={},u=function(e,t,n){const s=(0,v.qP)(e,!0);if(i.records[s[1]]&&i.records[s[1]][s[0]]&&(0==i.records[s[1]][s[0]].element.classList.contains("readonly")||l)){const o=i.records[s[1]][s[0]].element.style[t];o!=n||l?i.records[s[1]][s[0]].element.style[t]=n:(n="",i.records[s[1]][s[0]].element.style[t]=""),a[e]||(a[e]=[]),c[e]||(c[e]=[]),a[e].push([t+":"+o]),c[e].push([t+":"+n])}};if(n&&o)"string"==typeof e&&u(e,n,o);else{const t=Object.keys(e);for(let n=0;n<t.length;n++){let s=e[t[n]];"string"==typeof s&&(s=s.split(";"));for(let e=0;e<s.length;e++)"string"==typeof s[e]&&(s[e]=s[e].split(":")),s[e][0].trim()&&u(t[n],s[e][0].trim(),s[e][1])}}let d=Object.keys(a);for(let e=0;e<d.length;e++)a[d[e]]=a[d[e]].join(";");d=Object.keys(c);for(let e=0;e<d.length;e++)c[d[e]]=c[d[e]].join(";");r||s.JB.call(i,{action:"setStyle",oldValue:a,newValue:c}),t.Z.call(i,"onchangestyle",i,c)},ce=function(e){const t=this;if(e)return"string"!=typeof e?ce.call(t):(e=(0,v.qP)(e,!0),t.records[e[1]][e[0]].element.getAttribute("title")||"");{const e={};for(let n=0;n<t.options.data.length;n++)for(let s=0;s<t.options.columns.length;s++){const o=t.records[n][s].element.getAttribute("title");o&&(e[(0,v.Ar)([s,n])]=o)}return e}};var ae=__webpack_require__(54);const ue=function(){return this.config},de=function(e,t){const n=this,s=Object.keys(e);let o;n.parent?o=n.parent:(t=!0,o=n),s.forEach((function(s){t?(o.config[s]=e[s],"toolbar"===s&&(!0===e[s]?o.showToolbar():!1===e[s]&&o.hideToolbar())):n.options[s]=e[s]}))};var pe=__webpack_require__(272);const he=function(){let e=this;!function(e){for(let t=0;t<je;t++){const[n,s]=ye[t];e[n]=s.bind(e)}}(e),e.table=document.createElement("table"),e.thead=document.createElement("thead"),e.tbody=document.createElement("tbody"),e.headers=[],e.cols=[],e.content=document.createElement("div"),e.content.classList.add("jss_content"),e.content.onscroll=function(t){ne.call(e,t)},e.content.onwheel=function(t){Q.call(e,t)};const t=document.createElement("div"),s=document.createTextNode(jSuites.translate("Search")+": ");e.searchInput=document.createElement("input"),e.searchInput.classList.add("jss_search"),t.appendChild(s),t.appendChild(e.searchInput),e.searchInput.onfocus=function(){e.resetSelection()};const o=document.createElement("div");if(e.options.pagination>0&&e.options.paginationOptions&&e.options.paginationOptions.length>0){e.paginationDropdown=document.createElement("select"),e.paginationDropdown.classList.add("jss_pagination_dropdown"),e.paginationDropdown.onchange=function(){e.options.pagination=parseInt(this.value),e.page(0)};for(let t=0;t<e.options.paginationOptions.length;t++){const n=document.createElement("option");n.value=e.options.paginationOptions[t],n.innerHTML=e.options.paginationOptions[t],e.paginationDropdown.appendChild(n)}e.paginationDropdown.value=e.options.pagination,o.appendChild(document.createTextNode(jSuites.translate("Show "))),o.appendChild(e.paginationDropdown),o.appendChild(document.createTextNode(jSuites.translate("entries")))}const l=document.createElement("div");l.classList.add("jss_filter"),l.appendChild(o),l.appendChild(t),e.colgroupContainer=document.createElement("colgroup");let r=document.createElement("col");if(r.setAttribute("width","50"),e.colgroupContainer.appendChild(r),e.options.nestedHeaders&&e.options.nestedHeaders.length>0&&e.options.nestedHeaders[0]&&e.options.nestedHeaders[0][0])for(let t=0;t<e.options.nestedHeaders.length;t++)e.thead.appendChild(n.UQ.call(e,e.options.nestedHeaders[t]));e.headerContainer=document.createElement("tr"),r=document.createElement("td"),r.classList.add("jss_selectall"),e.headerContainer.appendChild(r);const i=k.call(e);for(let t=0;t<i;t++)F.call(e,t),e.headerContainer.appendChild(e.headers[t]),e.colgroupContainer.appendChild(e.cols[t].colElement);if(e.thead.appendChild(e.headerContainer),1==e.options.filters){e.filter=document.createElement("tr");const t=document.createElement("td");e.filter.appendChild(t);for(let t=0;t<e.options.columns.length;t++){const n=document.createElement("td");n.innerHTML="&nbsp;",n.setAttribute("data-x",t),n.className="jss_column_filter","hidden"==e.options.columns[t].type&&(n.style.display="none"),e.filter.appendChild(n)}e.thead.appendChild(e.filter)}e.table=document.createElement("table"),e.table.classList.add("jss_worksheet"),e.table.setAttribute("cellpadding","0"),e.table.setAttribute("cellspacing","0"),e.table.setAttribute("unselectable","yes"),e.table.appendChild(e.colgroupContainer),e.table.appendChild(e.thead),e.table.appendChild(e.tbody),e.options.textOverflow||e.table.classList.add("jss_overflow"),e.corner=document.createElement("div"),e.corner.className="jss_corner",e.corner.setAttribute("unselectable","on"),e.corner.setAttribute("onselectstart","return false"),0==e.options.selectionCopy&&(e.corner.style.display="none"),e.textarea=document.createElement("textarea"),e.textarea.className="jss_textarea",e.textarea.id="jss_textarea",e.textarea.tabIndex="-1";const c=document.createElement("a");c.setAttribute("href","https://bossanova.uk/jspreadsheet/"),e.ads=document.createElement("div"),e.ads.className="jss_about";const a=document.createElement("span");a.innerHTML="Jspreadsheet CE",c.appendChild(a),e.ads.appendChild(c),document.createElement("div").classList.add("jss_table"),e.pagination=document.createElement("div"),e.pagination.classList.add("jss_pagination");const u=document.createElement("div"),d=document.createElement("div");if(e.pagination.appendChild(u),e.pagination.appendChild(d),e.options.pagination||(e.pagination.style.display="none"),1==e.options.search&&e.element.appendChild(l),e.content.appendChild(e.table),e.content.appendChild(e.corner),e.content.appendChild(e.textarea),e.element.appendChild(e.content),e.element.appendChild(e.pagination),e.element.appendChild(e.ads),e.element.classList.add("jss_container"),e.element.jssWorksheet=e,e.element.jspreadsheet=e,1==e.options.tableOverflow&&(e.options.tableHeight&&(e.content.style["overflow-y"]="auto",e.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",e.content.style.maxHeight="string"==typeof e.options.tableHeight?e.options.tableHeight:e.options.tableHeight+"px"),e.options.tableWidth&&(e.content.style["overflow-x"]="auto",e.content.style.width="string"==typeof e.options.tableWidth?e.options.tableWidth:e.options.tableWidth+"px")),1!=e.options.tableOverflow&&e.parent.config.toolbar&&e.element.classList.add("with-toolbar"),0!=e.options.columnDrag&&e.thead.classList.add("draggable"),0!=e.options.columnResize&&e.thead.classList.add("resizable"),0!=e.options.rowDrag&&e.tbody.classList.add("draggable"),0!=e.options.rowResize&&e.tbody.classList.add("resizable"),e.setData.call(e),e.options.style&&(e.setStyle(e.options.style,null,null,1,1),delete e.options.style),Object.defineProperty(e.options,"style",{enumerable:!0,configurable:!0,get(){return e.getStyle()}}),e.options.comments&&e.setComments(e.options.comments),e.options.classes){const t=Object.keys(e.options.classes);for(let n=0;n<t.length;n++){const s=(0,v.qP)(t[n],!0);e.records[s[1]][s[0]].element.classList.add(e.options.classes[t[n]])}}},me=function(){const e=this;1==e.options.lazyLoading&&1!=e.options.tableOverflow&&1!=e.parent.config.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),e.options.lazyLoading=!1),e.options.columns||(e.options.columns=[]);let t,n=e.options.columns.length;if(e.options.data&&void 0!==e.options.data[0])if(Array.isArray(e.options.data[0])){const t=e.options.data[0].length;t>n&&(n=t)}else t=Object.keys(e.options.data[0]),t.length>n&&(n=t.length);e.options.minDimensions||(e.options.minDimensions=[0,0]),e.options.minDimensions[0]>n&&(n=e.options.minDimensions[0]);const s=[];for(let o=0;o<n;o++)e.options.columns[o]||(e.options.columns[o]={}),!e.options.columns[o].name&&t&&t[o]&&(e.options.columns[o].name=t[o]),"dropdown"==e.options.columns[o].type&&e.options.columns[o].url&&s.push({url:e.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(t){e.options.columns[this.index].source||(e.options.columns[this.index].source=[]);for(let n=0;n<t.length;n++)e.options.columns[this.index].source.push(t[n])}});s.length?jSuites.ajax(s,(function(){he.call(e)})):he.call(e)},fe=function(e){const t=/^Sheet(\d+)$/;let n=0;return e.worksheets.forEach((function(e){const s=t.exec(e.options.worksheetName);s&&(n=Math.max(n,parseInt(s[1])))})),"Sheet"+(n+1)},ge=async function(){const t=this,n=t.element,s=t.parent;"object"==typeof s.plugins&&Object.entries(s.plugins).forEach((function([,e]){"function"==typeof e.beforeinit&&e.beforeinit(t)})),e.jspreadsheet.current=t,n.setAttribute("tabindex",1),n.addEventListener("focus",(function(n){e.jspreadsheet.current&&!t.selectedCell&&t.updateSelectionFromCoords(0,0,0,0)}));const o=[];if(t.options.csv){const e=new Promise((e=>{jSuites.ajax({url:t.options.csv,method:"GET",dataType:"text",success:function(n){const s=(0,E.parseCSV)(n,t.options.csvDelimiter);if(1==t.options.csvHeaders&&s.length>0){const e=s.shift();if(e.length>0){t.options.columns||(t.options.columns=[]);for(let n=0;n<e.length;n++)t.options.columns[n]||(t.options.columns[n]={}),void 0===t.options.columns[n].title&&(t.options.columns[n].title=e[n])}}t.options.data=s,me.call(t),e()}})}));o.push(e)}else if(t.options.url){const e=new Promise((e=>{jSuites.ajax({url:t.options.url,method:"GET",dataType:"json",success:function(n){t.options.data=n.data?n.data:n,me.call(t),e()}})}));o.push(e)}else me.call(t);await Promise.all(o),"object"==typeof s.plugins&&Object.entries(s.plugins).forEach((function([,e]){"function"==typeof e.init&&e.init(t)}))},Ce=function(e){const t=this.parent;e.worksheetName||(e.worksheetName=fe(this.parent));const n={parent:t,options:e,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return t.config.worksheets.push(n.options),t.worksheets.push(n),n},ye=[["selectAll",A.td],["updateSelectionFromCoords",function(e,t,n,s){return A.Es.call(this,e,t,n,s)}],["resetSelection",function(){return A.yE.call(this)}],["getSelection",A.Mf],["getSelected",A.ey],["getSelectedColumns",A.H7],["getSelectedRows",A.Ym],["getData",function(e,t,n,s){const o=this,l=[];let r=0,i=0;const c=Math.max(...o.options.data.map((function(e){return e.length}))),a=o.options.data.length;for(let n=0;n<a;n++){r=0;for(let s=0;s<c;s++)e&&!o.records[n][s].element.classList.contains("highlight")||(l[i]||(l[i]=[]),l[i][r]=t?o.records[n][s].element.innerHTML:o.options.data[n][s],r++);r>0&&i++}return n?l.map((function(e){return e.join(n)})).join("\r\n")+"\r\n":s?l.map((function(e){const t={};return e.forEach((function(e,n){t[n]=e})),t})):l}],["setData",function(e){const t=this;if(e&&(t.options.data=e),t.options.data||(t.options.data=[]),t.options.data&&t.options.data[0]&&!Array.isArray(t.options.data[0])){e=[];for(let n=0;n<t.options.data.length;n++){const s=[];for(let e=0;e<t.options.columns.length;e++)s[e]=t.options.data[n][t.options.columns[e].name];e.push(s)}t.options.data=e}let s=0,o=0;const l=t.options.columns&&t.options.columns.length||0,r=t.options.data.length,i=t.options.minDimensions[0],c=t.options.minDimensions[1],a=i>l?i:l,u=c>r?c:r;for(s=0;s<u;s++)for(o=0;o<a;o++)null==t.options.data[s]&&(t.options.data[s]=[]),null==t.options.data[s][o]&&(t.options.data[s][o]="");let d,p;for(t.rows=[],t.results=null,t.records=[],t.history=[],t.historyIndex=-1,t.tbody.innerHTML="",1==t.options.lazyLoading?(d=0,p=t.options.data.length<100?t.options.data.length:100,t.options.pagination&&(t.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):t.options.pagination?(t.pageNumber||(t.pageNumber=0),t.options.pagination,d=t.options.pagination*t.pageNumber,p=t.options.pagination*t.pageNumber+t.options.pagination,t.options.data.length<p&&(p=t.options.data.length)):(d=0,p=t.options.data.length),s=0;s<t.options.data.length;s++){const e=S.call(t,s,t.options.data[s]);s>=d&&s<p&&t.tbody.appendChild(e.element)}if(1==t.options.lazyLoading||t.options.pagination&&re.Ik.call(t),t.options.mergeCells){const e=Object.keys(t.options.mergeCells);for(let n=0;n<e.length;n++){const s=t.options.mergeCells[e[n]];_.mt.call(t,e[n],s[0],s[1],1)}}n.T0.call(t)}],["getValue",function(e,t){const n=this;let s,o;if("string"!=typeof e)return null;s=(e=(0,v.qP)(e,!0))[0],o=e[1];let l=null;return null!=s&&null!=o&&(n.records[o]&&n.records[o][s]&&t?l=n.records[o][s].element.innerHTML:n.options.data[o]&&"undefined"!=n.options.data[o][s]&&(l=n.options.data[o][s])),l}],["getValueFromCoords",function(e,t,n){const s=this;let o=null;return null!=e&&null!=t&&(s.records[t]&&s.records[t][e]&&n?o=s.records[t][e].element.innerHTML:s.options.data[t]&&"undefined"!=s.options.data[t][e]&&(o=s.options.data[t][e])),o}],["setValue",function(e,o,l){const r=this,i=[];if("string"==typeof e){const t=(0,v.qP)(e,!0),s=t[0],c=t[1];i.push(n.wW.call(r,s,c,o,l)),n.Zz.call(r,s,c,i)}else{let t=null,s=null;if(e&&e.getAttribute&&(t=e.getAttribute("data-x"),s=e.getAttribute("data-y")),null!=t&&null!=s)i.push(n.wW.call(r,t,s,o,l)),n.Zz.call(r,t,s,i);else{const t=Object.keys(e);if(t.length>0)for(let s=0;s<t.length;s++){let t,c;if("string"==typeof e[s]){const n=(0,v.qP)(e[s],!0);t=n[0],c=n[1]}else null!=e[s].x&&null!=e[s].y?(t=e[s].x,c=e[s].y,null!=e[s].value&&(o=e[s].value)):(t=e[s].getAttribute("data-x"),c=e[s].getAttribute("data-y"));null!=t&&null!=c&&(i.push(n.wW.call(r,t,c,o,l)),n.Zz.call(r,t,c,i))}}}s.JB.call(r,{action:"setValue",records:i,selection:r.selectedCell}),n.T0.call(r);const c=i.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));t.Z.call(r,"onafterchanges",r,c)}],["setValueFromCoords",function(e,o,l,r){const i=this,c=[];c.push(n.wW.call(i,e,o,l,r)),n.Zz.call(i,e,o,c),s.JB.call(i,{action:"setValue",records:c,selection:i.selectedCell}),n.T0.call(i);const a=c.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));t.Z.call(i,"onafterchanges",i,a)}],["getWidth",function(e){const t=this;let n;if(void 0===e){n=[];for(let e=0;e<t.headers.length;e++)n.push(t.options.columns&&t.options.columns[e]&&t.options.columns[e].width||t.options.defaultColWidth||100)}else n=parseInt(t.cols[e].colElement.getAttribute("width"));return n}],["setWidth",function(e,t){return B.call(this,e,t)}],["insertRow",function(e,o,l){const r=this;if(0!=r.options.allowInsertRow){let i,c=[];Array.isArray(e)?(i=1,e&&(c=e)):i=void 0!==e?e:1,l=!!l;const a=r.options.data.length-1;(null==o||o>=parseInt(a)||o<0)&&(o=a);const u=[];for(let e=0;e<i;e++){const t=[];for(let e=0;e<r.options.columns.length;e++)t[e]=c[e]?c[e]:"";u.push({row:e+o+(l?0:1),data:t})}if(!1===t.Z.call(r,"onbeforeinsertrow",r,u))return!1;if(r.options.mergeCells&&Object.keys(r.options.mergeCells).length>0&&_.q4.call(r,o,l).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;r.destroyMerge()}if(1==r.options.search){if(r.results&&r.results.length!=r.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;r.resetSearch()}r.results=null}const d=l?o:o+1,p=r.records.splice(d),h=r.options.data.splice(d),m=r.rows.splice(d),f=[],g=[],C=[];for(let e=d;e<i+d;e++){r.options.data[e]=[];for(let t=0;t<r.options.columns.length;t++)r.options.data[e][t]=c[t]?c[t]:"";const t=S.call(r,e,r.options.data[e]);m[0]?Array.prototype.indexOf.call(r.tbody.children,m[0].element)>=0&&r.tbody.insertBefore(t.element,m[0].element):Array.prototype.indexOf.call(r.tbody.children,r.rows[o].element)>=0&&r.tbody.appendChild(t.element),f.push(r.records[e]),g.push(r.options.data[e]),C.push(t)}Array.prototype.push.apply(r.records,p),Array.prototype.push.apply(r.options.data,h),Array.prototype.push.apply(r.rows,m);for(let e=d;e<r.rows.length;e++)r.rows[e].y=e;for(let e=d;e<r.records.length;e++)for(let t=0;t<r.records[e].length;t++)r.records[e][t].y=e;r.options.pagination>0&&r.page(r.pageNumber),s.JB.call(r,{action:"insertRow",rowNumber:o,numOfRows:i,insertBefore:l,rowRecords:f,rowData:g,rowNode:C}),n.ec.call(r),t.Z.call(r,"oninsertrow",r,u)}}],["moveRow",function(e,t){return M.call(this,e,t)}],["deleteRow",function(e,o){const l=this;if(0!=l.options.allowDeleteRow)if(1==l.options.allowDeletingAllRows||l.options.data.length>1){if(null==e){const t=A.Ym.call(l);0===t.length?(e=l.options.data.length-1,o=1):(e=t[0],o=t.length)}let r=l.options.data.length-1;(null==e||e>r||e<0)&&(e=r),o||(o=1),e+o>=l.options.data.length&&(o=l.options.data.length-e);const i=[];for(let t=0;t<o;t++)i.push(t+e);if(!1===t.Z.call(l,"onbeforedeleterow",l,i))return!1;if(parseInt(e)>-1){let c=!1;if(l.options.mergeCells&&Object.keys(l.options.mergeCells).length>0)for(let t=e;t<e+o;t++)_.q4.call(l,t,!1).length&&(c=!0);if(c){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;l.destroyMerge()}if(1==l.options.search){if(l.results&&l.results.length!=l.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;l.resetSearch()}l.results=null}1!=l.options.allowDeletingAllRows&&r+1===o&&(o--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(let t=e;t<e+o;t++)Array.prototype.indexOf.call(l.tbody.children,l.rows[t].element)>=0&&(l.rows[t].element.className="",l.rows[t].element.parentNode.removeChild(l.rows[t].element));const a=l.records.splice(e,o),u=l.options.data.splice(e,o),d=l.rows.splice(e,o);for(let t=e;t<l.rows.length;t++)l.rows[t].y=t;for(let t=e;t<l.records.length;t++)for(let e=0;e<l.records[t].length;e++)l.records[t][e].y=t;l.options.pagination>0&&l.tbody.children.length!=l.options.pagination&&l.page(l.pageNumber),A.Uv.call(l,1,e,e+o-1),s.JB.call(l,{action:"deleteRow",rowNumber:e,numOfRows:o,insertBefore:1,rowRecords:a,rowData:u,rowNode:d}),n.ec.call(l),t.Z.call(l,"ondeleterow",l,i)}}else console.error("Jspreadsheet: It is not possible to delete the last row")}],["hideRow",function(e){const t=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){t.rows[e].element.style.display="none"}))}],["showRow",function(e){const t=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){t.rows[e].element.style.display=""}))}],["getRowData",function(e,t){return t?this.records[e].map((function(e){return e.element.innerHTML})):this.options.data[e]}],["setRowData",function(e,t,n){const s=this;for(let o=0;o<s.headers.length;o++){const l=(0,v.Ar)([o,e]);null!=t[o]&&s.setValue(l,t[o],n)}}],["getHeight",function(e){const t=this;let n;if(void 0===e){n=[];for(let e=0;e<t.rows.length;e++){const s=t.rows[e].element.style.height;s&&(n[e]=s)}}else"object"==typeof e&&(e=$(e).getAttribute("data-y")),n=t.rows[e].element.style.height;return n}],["setHeight",function(e,t){return O.call(this,e,t)}],["getMerge",_.D8],["setMerge",function(e,t,n){return _.mt.call(this,e,t,n)}],["destroyMerge",function(){return _.tW.call(this)}],["removeMerge",function(e,t){return _.Vg.call(this,e,t)}],["search",function(e){const t=this;if(t.options.filters&&L.aw.call(t),t.resetSelection(),t.pageNumber=0,t.results=[],e){t.searchInput.value!==e&&(t.searchInput.value=e);const n=function(e,n,s){for(let o=0;o<e.length;o++)if((""+e[o]).toLowerCase().search(n)>=0||(""+t.records[s][o].element.innerHTML).toLowerCase().search(n)>=0)return!0;return!1},s=function(e){-1==t.results.indexOf(e)&&t.results.push(e)};let o=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");o=new RegExp(o,"i"),t.options.data.forEach((function(e,l){if(n(e,o,l)){const e=_.q4.call(t,l);if(e.length)for(let n=0;n<e.length;n++){const o=(0,v.qP)(e[n],!0);for(let l=0;l<t.options.mergeCells[e[n]][1];l++)s(o[1]+l)}else s(l)}}))}else t.results=null;n.cW.call(t)}],["resetSearch",function(){const e=this;e.searchInput.value="",e.search(""),e.results=null}],["getHeader",function(e){return this.headers[e].textContent}],["getHeaders",function(e){const t=this,n=[];for(let e=0;e<t.headers.length;e++)n.push(t.getHeader(e));return e?n:n.join(t.options.csvDelimiter)}],["setHeader",function(e,n){const o=this;if(o.headers[e]){const l=o.headers[e].textContent,r=o.options.columns&&o.options.columns[e]&&o.options.columns[e].title||"";n||(n=(0,E.getColumnName)(e)),o.headers[e].textContent=n,o.headers[e].setAttribute("title",n),o.options.columns||(o.options.columns=[]),o.options.columns[e]||(o.options.columns[e]={}),o.options.columns[e].title=n,s.JB.call(o,{action:"setHeader",column:e,oldValue:l,newValue:n}),t.Z.call(o,"onchangeheader",o,parseInt(e),n,r)}}],["getStyle",function(e,t){const n=this;if(e)return e=(0,v.qP)(e,!0),t?n.records[e[1]][e[0]].element.style[t]:n.records[e[1]][e[0]].element.getAttribute("style");{const e={},s=n.options.data[0].length,o=n.options.data.length;for(let l=0;l<o;l++)for(let o=0;o<s;o++){const s=t?n.records[l][o].element.style[t]:n.records[l][o].element.getAttribute("style");s&&(e[(0,v.Ar)([o,l])]=s)}return e}}],["setStyle",function(e,t,n,s){return ie.call(this,e,t,n,s)}],["resetStyle",function(e,t){const n=this,s=Object.keys(e);for(let e=0;e<s.length;e++){const t=(0,v.qP)(s[e],!0);n.records[t[1]]&&n.records[t[1]][t[0]]&&n.records[t[1]][t[0]].element.setAttribute("style","")}n.setStyle(e,null,null,null,t)}],["insertColumn",function(e,o,l,r){const i=this;if(0!=i.options.allowInsertColumn){let c,a=[];Array.isArray(e)?(c=1,e&&(a=e)):c="number"==typeof e?e:1,l=!!l;const u=Math.max(i.options.columns.length,...i.options.data.map((function(e){return e.length})))-1;(null==o||o>=parseInt(u)||o<0)&&(o=u),r||(r=[]);for(let e=0;e<c;e++)r[e]||(r[e]={});const d=[];if(Array.isArray(e)){const t=[];for(let n=0;n<i.options.data.length;n++)t.push(n<e.length?e[n]:"");const n={column:o+(l?0:1),options:Object.assign({},r[0]),data:t};d.push(n)}else for(let t=0;t<e;t++){const e={column:o+t+(l?0:1),options:Object.assign({},r[t])};d.push(e)}if(!1===t.Z.call(i,"onbeforeinsertcolumn",i,d))return!1;if(i.options.mergeCells&&Object.keys(i.options.mergeCells).length>0&&_.D0.call(i,o,l).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;i.destroyMerge()}const p=l?o:o+1;i.options.columns=(0,v.Wc)(i.options.columns,p,r);const h=i.headers.splice(p),m=i.cols.splice(p),f=[],g=[],C=[],y=[],j=[];for(let e=p;e<c+p;e++)F.call(i,e),i.headerContainer.insertBefore(i.headers[e],i.headerContainer.children[e+1]),i.colgroupContainer.insertBefore(i.cols[e].colElement,i.colgroupContainer.children[e+1]),f.push(i.headers[e]),g.push(i.cols[e]);if(i.options.footers)for(let e=0;e<i.options.footers.length;e++){j[e]=[];for(let t=0;t<c;t++)j[e].push("");i.options.footers[e].splice(p,0,j[e])}for(let e=0;e<i.options.data.length;e++){const t=i.options.data[e].splice(p),s=i.records[e].splice(p);y[e]=[],C[e]=[];for(let t=p;t<c+p;t++){const s=a[e]?a[e]:"";i.options.data[e][t]=s;const o=n.kE.call(i,t,e,i.options.data[e][t]);i.records[e][t]={element:o,y:e},i.rows[e]&&i.rows[e].element.insertBefore(o,i.rows[e].element.children[t+1]),i.options.columns&&i.options.columns[t]&&"function"==typeof i.options.columns[t].render&&i.options.columns[t].render(o,s,parseInt(t),parseInt(e),i,i.options.columns[t]),y[e].push(s),C[e].push({element:o,x:t,y:e})}Array.prototype.push.apply(i.options.data[e],t),Array.prototype.push.apply(i.records[e],s)}Array.prototype.push.apply(i.headers,h),Array.prototype.push.apply(i.cols,m);for(let e=p;e<i.cols.length;e++)i.cols[e].x=e;for(let e=0;e<i.records.length;e++)for(let t=0;t<i.records[e].length;t++)i.records[e][t].x=t;if(i.options.nestedHeaders&&i.options.nestedHeaders.length>0&&i.options.nestedHeaders[0]&&i.options.nestedHeaders[0][0])for(let e=0;e<i.options.nestedHeaders.length;e++){const t=parseInt(i.options.nestedHeaders[e][i.options.nestedHeaders[e].length-1].colspan)+c;i.options.nestedHeaders[e][i.options.nestedHeaders[e].length-1].colspan=t,i.thead.children[e].children[i.thead.children[e].children.length-1].setAttribute("colspan",t);let n=i.thead.children[e].children[i.thead.children[e].children.length-1].getAttribute("data-column");n=n.split(",");for(let e=p;e<c+p;e++)n.push(e);i.thead.children[e].children[i.thead.children[e].children.length-1].setAttribute("data-column",n)}s.JB.call(i,{action:"insertColumn",columnNumber:o,numOfColumns:c,insertBefore:l,columns:r,headers:f,cols:g,records:C,footers:j,data:y}),n.ec.call(i),t.Z.call(i,"oninsertcolumn",i,d)}}],["moveColumn",function(e,o){const l=this;if(l.options.mergeCells&&Object.keys(l.options.mergeCells).length>0){let t;if(t=e>o?1:0,_.D0.call(l,e).length||_.D0.call(l,o,t).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;l.destroyMerge()}}if((e=parseInt(e))>(o=parseInt(o))){l.headerContainer.insertBefore(l.headers[e],l.headers[o]),l.colgroupContainer.insertBefore(l.cols[e].colElement,l.cols[o].colElement);for(let t=0;t<l.rows.length;t++)l.rows[t].element.insertBefore(l.records[t][e].element,l.records[t][o].element)}else{l.headerContainer.insertBefore(l.headers[e],l.headers[o].nextSibling),l.colgroupContainer.insertBefore(l.cols[e].colElement,l.cols[o].colElement.nextSibling);for(let t=0;t<l.rows.length;t++)l.rows[t].element.insertBefore(l.records[t][e].element,l.records[t][o].element.nextSibling)}l.options.columns.splice(o,0,l.options.columns.splice(e,1)[0]),l.headers.splice(o,0,l.headers.splice(e,1)[0]),l.cols.splice(o,0,l.cols.splice(e,1)[0]);const r=Math.min(e,o),i=Math.max(e,o);for(let t=0;t<l.rows.length;t++)l.options.data[t].splice(o,0,l.options.data[t].splice(e,1)[0]),l.records[t].splice(o,0,l.records[t].splice(e,1)[0]);for(let e=r;e<=i;e++)l.cols[e].x=e;for(let e=0;e<l.records.length;e++)for(let t=r;t<=i;t++)l.records[e][t].x=t;if(l.options.footers)for(let t=0;t<l.options.footers.length;t++)l.options.footers[t].splice(o,0,l.options.footers[t].splice(e,1)[0]);s.JB.call(l,{action:"moveColumn",oldValue:e,newValue:o}),n.ec.call(l),t.Z.call(l,"onmovecolumn",l,e,o,1)}],["deleteColumn",function(e,o){const l=this;if(0!=l.options.allowDeleteColumn)if(l.headers.length>1){if(null==e){const t=l.getSelectedColumns(!0);t.length?(e=parseInt(t[0]),o=parseInt(t.length)):(e=l.headers.length-1,o=1)}const r=l.options.data[0].length-1;(null==e||e>r||e<0)&&(e=r),o||(o=1),o>l.options.data[0].length-e&&(o=l.options.data[0].length-e);const i=[];for(let t=0;t<o;t++)i.push(t+e);if(!1===t.Z.call(l,"onbeforedeletecolumn",l,i))return!1;if(parseInt(e)>-1){let r=!1;if(l.options.mergeCells&&Object.keys(l.options.mergeCells).length>0)for(let t=e;t<e+o;t++)_.D0.call(l,t,!1).length&&(r=!0);if(r){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;l.destroyMerge()}const c=l.options.columns?l.options.columns.splice(e,o):void 0;for(let t=e;t<e+o;t++)l.cols[t].colElement.className="",l.headers[t].className="",l.cols[t].colElement.parentNode.removeChild(l.cols[t].colElement),l.headers[t].parentNode.removeChild(l.headers[t]);const a=l.headers.splice(e,o),u=l.cols.splice(e,o),d=[],p=[],h=[];for(let t=0;t<l.options.data.length;t++)for(let n=e;n<e+o;n++)l.records[t][n].element.className="",l.records[t][n].element.parentNode.removeChild(l.records[t][n].element);for(let t=0;t<l.options.data.length;t++)p[t]=l.options.data[t].splice(e,o),d[t]=l.records[t].splice(e,o);for(let t=e;t<l.cols.length;t++)l.cols[t].x=t;for(let t=0;t<l.records.length;t++)for(let n=e;n<l.records[t].length;n++)l.records[t][n].x=n;if(l.options.footers)for(let t=0;t<l.options.footers.length;t++)h[t]=l.options.footers[t].splice(e,o);if(A.Uv.call(l,0,e,e+o-1),l.options.nestedHeaders&&l.options.nestedHeaders.length>0&&l.options.nestedHeaders[0]&&l.options.nestedHeaders[0][0])for(let e=0;e<l.options.nestedHeaders.length;e++){const t=parseInt(l.options.nestedHeaders[e][l.options.nestedHeaders[e].length-1].colspan)-o;l.options.nestedHeaders[e][l.options.nestedHeaders[e].length-1].colspan=t,l.thead.children[e].children[l.thead.children[e].children.length-1].setAttribute("colspan",t)}s.JB.call(l,{action:"deleteColumn",columnNumber:e,numOfColumns:o,insertBefore:1,columns:c,headers:a,cols:u,records:d,footers:h,data:p}),n.ec.call(l),t.Z.call(l,"ondeletecolumn",l,i)}}else console.error("Jspreadsheet: It is not possible to delete the last column")}],["getColumnData",function(e,t){const n=this,s=[];for(let o=0;o<n.options.data.length;o++)t?s.push(n.records[o][e].element.innerHTML):s.push(n.options.data[o][e]);return s}],["setColumnData",function(e,t,n){const s=this;for(let o=0;o<s.rows.length;o++){const l=(0,v.Ar)([e,o]);null!=t[o]&&s.setValue(l,t[o],n)}}],["whichPage",re.an],["page",re.Md],["download",function(e,t){const n=this;if(0==n.parent.config.allowExport)console.error("Export not allowed");else{let s="";s+=x.call(n,!1,n.options.csvDelimiter,!0,e,!0,void 0,t);const o=new Blob(["\ufeff"+s],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,(n.options.csvFileName||n.options.worksheetName)+".csv");else{const e=document.createElement("a"),t=URL.createObjectURL(o);e.href=t,e.setAttribute("download",(n.options.csvFileName||n.options.worksheetName)+".csv"),document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)}}}],["getComments",ce],["setComments",function(e,n){const o=this;let l;l="string"==typeof e?{[e]:n}:e;const r={};Object.entries(l).forEach((function([e,t]){const n=(0,E.getCoordsFromCellName)(e);r[e]=o.records[n[1]][n[0]].element.getAttribute("title"),o.records[n[1]][n[0]].element.setAttribute("title",t||""),t?(o.records[n[1]][n[0]].element.classList.add("jss_comments"),o.options.comments||(o.options.comments={}),o.options.comments[e]=t):(o.records[n[1]][n[0]].element.classList.remove("jss_comments"),o.options.comments&&o.options.comments[e]&&delete o.options.comments[e])})),s.JB.call(o,{action:"setComments",newValue:l,oldValue:r}),t.Z.call(o,"oncomments",o,l,r)}],["orderBy",ae.Xo],["undo",s.Yw],["redo",s.KX],["getCell",n.$S],["getCellFromCoords",n.Sl],["getLabel",n.id],["getConfig",function(){return this.options}],["setConfig",de],["getMeta",function(e){return pe.xZ.call(this,e)}],["setMeta",pe.US],["showColumn",function(e){const t=this;Array.isArray(e)||(e=[e]);for(let n=0;n<e.length;n++){const s=e[n];t.headers[s].style.display="",t.cols[s].colElement.style.display="",t.filter&&t.filter.children.length>s+1&&(t.filter.children[s+1].style.display="");for(let e=0;e<t.options.data.length;e++)t.records[e][s].element.style.display=""}t.options.footers&&I.i.call(t),t.resetSelection()}],["hideColumn",function(e){const t=this;Array.isArray(e)||(e=[e]);for(let n=0;n<e.length;n++){const s=e[n];t.headers[s].style.display="none",t.cols[s].colElement.style.display="none",t.filter&&t.filter.children.length>s+1&&(t.filter.children[s+1].style.display="none");for(let e=0;e<t.options.data.length;e++)t.records[e][s].element.style.display="none"}t.options.footers&&I.i.call(t),t.resetSelection()}],["showIndex",n.UI],["hideIndex",n.TO],["getWorksheetActive",n.X0],["openEditor",o],["closeEditor",l],["createWorksheet",function(e){const t=this.parent;t.creationThroughJss=!0,Ce.call(this,e),t.element.tabs.create(e.worksheetName)}],["openWorksheet",function(e){this.parent.element.tabs.open(e)}],["deleteWorksheet",function(e){const n=this;n.parent.element.tabs.remove(e);const s=n.parent.worksheets.splice(e,1)[0];t.Z.call(n.parent,"ondeleteworksheet",s,e)}],["copy",function(e){e?Y():x.call(this,!0)}],["paste",D],["executeFormula",n.pX],["getDataFromRange",function(e,t){const n=this,s=(0,E.getCoordsFromRange)(e),o=[];for(let e=s[1];e<=s[3];e++){o.push([]);for(let l=s[0];l<=s[2];l++)t?o[o.length-1].push(n.records[e][l].element.innerHTML):o[o.length-1].push(n.options.data[e][l])}return o}],["quantiyOfPages",re.ur],["getRange",A.rx],["isSelected",A.VL],["setReadOnly",function(e,t){const n=this;let s;if("string"==typeof e){const t=(0,E.getCoordsFromCellName)(e);s=n.records[t[1]][t[0]]}else{const t=parseInt(e.getAttribute("data-x")),o=parseInt(e.getAttribute("data-y"));s=n.records[o][t]}t?s.element.classList.add("readonly"):s.element.classList.remove("readonly")}],["isReadOnly",function(e,t){if("string"==typeof e&&void 0===t){const n=(0,E.getCoordsFromCellName)(e);[e,t]=n}return this.records[t][e].element.classList.contains("readonly")}],["getHighlighted",A.VD],["dispatch",t.Z],["down",g],["first",b],["last",w],["left",j],["right",h],["up",u],["openFilter",L.B4],["resetFilters",L.aw]],je=ye.length,be=function(){};be.spreadsheet=async function(s,o,l){if("TABLE"==s.tagName){o||(o={}),o.worksheets||(o.worksheets=[]);const e=(0,E.createFromTable)(s,o.worksheets[0]);o.worksheets[0]=e;const t=document.createElement("div");s.parentNode.insertBefore(t,s),s.remove(),s=t}let r={worksheets:l,config:o,element:s,el:s};return r.contextMenu=document.createElement("div"),r.contextMenu.className="jss_contextmenu",r.getWorksheetActive=n.X0.bind(r),r.fullscreen=n.Gr.bind(r),r.showToolbar=le.bv.bind(r),r.hideToolbar=le.iu.bind(r),r.getConfig=ue.bind(r),r.setConfig=de.bind(r),r.setPlugins=function(t){r.plugins||(r.plugins={}),"object"==typeof t&&Object.entries(t).forEach((function([t,n]){r.plugins[t]=n.call(e.jspreadsheet,r,{},r.config)}))},r.setPlugins(o.plugins),await async function(e,n,s){let o=n.worksheets;if(!o)throw new Error("JSS: worksheets are not defined");{let l={animation:!0,onbeforecreate:function(t,n){return n||fe(e)},oncreate:function(s,o){if(e.creationThroughJss)e.creationThroughJss=!1;else{const t=s.tabs.headers.children[s.tabs.headers.children.length-2].innerHTML;Ce.call(e.worksheets[0],{minDimensions:[10,15],worksheetName:t})}const l=e.worksheets[e.worksheets.length-1];l.element=o,ge.call(l).then((function(){(0,le.yf)(l),t.Z.call(l,"oncreateworksheet",l,n,e.worksheets.length-1)}))},onchange:function(t,n,s){0!=e.worksheets.length&&e.worksheets[s]&&(0,le.yf)(e.worksheets[s])}};1==n.tabs?l.allowCreate=!0:l.hideHeaders=!0,l.data=[];let r=1;for(let e=0;e<o.length;e++)o[e].worksheetName||(o[e].worksheetName="Sheet"+r++),l.data.push({title:o[e].worksheetName,content:""});s.classList.add("jss_spreadsheet");const i=jSuites.tabs(s,l);for(let t=0;t<o.length;t++)e.worksheets.push({parent:e,element:i.content.children[t],options:o[t],filters:[],formula:[],history:[],selection:[],historyIndex:-1}),await ge.call(e.worksheets[t])}}(r,o,s),r.element.appendChild(r.contextMenu),jSuites.contextmenu(r.contextMenu,{onclick:function(){r.contextMenu.contextmenu.close(!1)}}),1==r.config.fullscreen&&r.element.classList.add("fullscreen"),le.bv.call(r),o.root?se(o.root):se(document),s.spreadsheet=r,r},be.worksheet=function(e,t,n){let s={parent:e,options:{}};return void 0===n?e.worksheets.push(s):e.worksheets.splice(n,0,s),Object.assign(s.options,t),s};var we=be;e.jspreadsheet=function(n,s){try{let o=[];return we.spreadsheet(n,s,o).then((n=>{e.jspreadsheet.spreadsheet.push(n),t.Z.call(n,"onload",n)})),o}catch(e){console.error(e)}},e.jspreadsheet.getWorksheetInstanceByName=function(t,n){const s=e.jspreadsheet.spreadsheet.find((e=>e.config.namespace===n));if(s)return{};if(null==t){const e=s.worksheets.map((e=>[e.options.worksheetName,e]));return Object.fromEntries(e)}return s.worksheets.find((e=>e.options.worksheetName===t))},e.jspreadsheet.setDictionary=function(e){jSuites.setDictionary(e)},e.jspreadsheet.destroy=function(t,n){if(t.spreadsheet){const s=e.jspreadsheet.spreadsheet.indexOf(t.spreadsheet);e.jspreadsheet.spreadsheet.splice(s,1);const o=t.spreadsheet.config.root||document;t.spreadsheet=null,t.innerHTML="",n&&oe(o)}},e.jspreadsheet.destroyAll=function(){for(let t=0;t<e.jspreadsheet.spreadsheet.length;t++){const n=e.jspreadsheet.spreadsheet[t];e.jspreadsheet.destroy(n.element)}},e.jspreadsheet.current=null,e.jspreadsheet.spreadsheet=[],e.jspreadsheet.helpers={},e.jspreadsheet.version=function(){return T},Object.entries(E).forEach((([t,n])=>{e.jspreadsheet.helpers[t]=n}));var _e=e.jspreadsheet}(),jspreadsheet=__webpack_exports__.default})();

    return jspreadsheet;
})));